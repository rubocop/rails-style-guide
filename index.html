<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.23">
<title>Rails Style Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .cd {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Rails Style Guide</h1>
<div id="toc" class="toc2">
<div id="toctitle"><h2>Table of Contents</h2></div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#configuration">Configuration</a>
<ul class="sectlevel2">
<li><a href="#config-initializers">Config Initializers</a></li>
<li><a href="#gem-initializers">Gem Initializers</a></li>
<li><a href="#dev-test-prod-configs">Dev/Test/Prod Configs</a></li>
<li><a href="#app-config">App Config</a></li>
<li><a href="#config-defaults">Load Rails Config Defaults</a></li>
<li><a href="#staging-like-prod">Staging Like Prod</a></li>
<li><a href="#yaml-config">YAML Config</a></li>
</ul>
</li>
<li><a href="#routing">Routing</a>
<ul class="sectlevel2">
<li><a href="#member-collection-routes">Member Collection Routes</a></li>
<li><a href="#many-member-collection-routes">Many Member Collection Routes</a></li>
<li><a href="#nested-routes">Nested Routes</a></li>
<li><a href="#shallow-routes">Shallow Routes</a></li>
<li><a href="#namespaced-routes">Namespaced Routes</a></li>
<li><a href="#no-wild-routes">No Wild Routes</a></li>
<li><a href="#no-match-routes">No Match Routes</a></li>
</ul>
</li>
<li><a href="#controllers">Controllers</a>
<ul class="sectlevel2">
<li><a href="#skinny-controllers">Skinny Controllers</a></li>
<li><a href="#one-method">One Method</a></li>
<li><a href="#shared-instance-variables">Shared Instance Variables</a></li>
<li><a href="#lexically-scoped-action-filter">Lexically Scoped Action Filter</a></li>
</ul>
</li>
<li><a href="#rendering">Controllers: Rendering</a>
<ul class="sectlevel2">
<li><a href="#inline-rendering">Inline Rendering</a></li>
<li><a href="#plain-text-rendering">Plain Text Rendering</a></li>
<li><a href="#http-status-code-symbols">HTTP Status Code Symbols</a></li>
</ul>
</li>
<li><a href="#models">Models</a>
<ul class="sectlevel2">
<li><a href="#model-classes">Model Classes</a></li>
<li><a href="#meaningful-model-names">Meaningful Model Names</a></li>
<li><a href="#non-activerecord-models">Non-ActiveRecord Models</a></li>
<li><a href="#model-business-logic">Model Business Logic</a></li>
</ul>
</li>
<li><a href="#activerecord">Models: Active Record</a>
<ul class="sectlevel2">
<li><a href="#keep-ar-defaults">Keep Active Record Defaults</a></li>
<li><a href="#append-ignored-columns">Always append to <code>ignored_columns</code></a></li>
<li><a href="#enums">Enums</a></li>
<li><a href="#macro-style-methods">Macro Style Methods</a></li>
<li><a href="#has-many-through"><code>has_many :through</code></a></li>
<li><a href="#read-attribute">Read Attribute</a></li>
<li><a href="#write-attribute">Write Attribute</a></li>
<li><a href="#new-style-validations">New-style Validations</a></li>
<li><a href="#custom-validation-methods">Custom Validation Methods</a></li>
<li><a href="#single-attribute-validations">Single-attribute Validations</a></li>
<li><a href="#custom-validator-file">Custom Validator File</a></li>
<li><a href="#app-validators">App Validators</a></li>
<li><a href="#custom-validators-gem">Custom Validators Gem</a></li>
<li><a href="#named-scopes">Named Scopes</a></li>
<li><a href="#named-scope-class">Named Scope Class</a></li>
<li><a href="#callbacks-order">Callbacks Order</a></li>
<li><a href="#beware-skip-model-validations">Beware Skip Model Validations</a></li>
<li><a href="#user-friendly-urls">User-friendly URLs</a></li>
<li><a href="#find-each"><code>find_each</code></a></li>
<li><a href="#before_destroy"><code>before_destroy</code></a></li>
<li><a href="#has_many-has_one-dependent-option"><code>has_many</code>/<code>has_one</code> Dependent Option</a></li>
<li><a href="#save-bang"><code>save!</code></a></li>
</ul>
</li>
<li><a href="#activerecord-queries">Models: Active Record Queries</a>
<ul class="sectlevel2">
<li><a href="#avoid-interpolation">Avoid Interpolation</a></li>
<li><a href="#named-placeholder">Named Placeholder</a></li>
<li><a href="#find"><code>find</code></a></li>
<li><a href="#find_by"><code>find_by</code></a></li>
<li><a href="#hash-conditions">Hash conditions </a></li>
<li><a href="#finding-missing-relationship-records">Finding missing relationship records</a></li>
<li><a href="#order-by-id">Order by <code>id</code></a></li>
<li><a href="#pluck"><code>pluck</code></a></li>
<li><a href="#pick"><code>pick</code></a></li>
<li><a href="#ids"><code>ids</code></a></li>
<li><a href="#squished-heredocs">Squished Heredocs</a></li>
<li><a href="#size-over-count-or-length"><code>size</code> over <code>count</code> or <code>length</code></a></li>
<li><a href="#where-ranges">Where with Ranges</a></li>
<li><a href="#where-not-with-multiple-attributes"><code>where.not</code> with multiple attributes</a></li>
<li><a href="#redundant-all">Redundant <code>all</code></a></li>
</ul>
</li>
<li><a href="#migrations">Migrations</a>
<ul class="sectlevel2">
<li><a href="#schema-version">Schema Version</a></li>
<li><a href="#db-schema-load">DB Schema Load</a></li>
<li><a href="#default-migration-values">Default Migration Values</a></li>
<li><a href="#three-state-boolean">3-state Boolean</a></li>
<li><a href="#foreign-key-constraints">Foreign Key Constraints</a></li>
<li><a href="#change-vs-up-down">Change vs Up/Down</a></li>
<li><a href="#define-model-class-migrations">Define Model Class Migrations</a></li>
<li><a href="#meaningful-foreign-key-naming">Meaningful Foreign Key Naming</a></li>
<li><a href="#reversible-migration">Reversible Migration</a></li>
</ul>
</li>
<li><a href="#views">Views</a>
<ul class="sectlevel2">
<li><a href="#no-direct-model-view">No Direct Model View</a></li>
<li><a href="#no-complex-view-formatting">No Complex View Formatting</a></li>
<li><a href="#partials">Partials</a></li>
<li><a href="#no-instance-variables-in-partials">No Instance Variables in Partials</a></li>
</ul>
</li>
<li><a href="#internationalization">Internationalization</a>
<ul class="sectlevel2">
<li><a href="#locale-texts">Locale Texts</a></li>
<li><a href="#translated-labels">Translated Labels</a></li>
<li><a href="#organize-locale-files">Organize Locale Files</a></li>
<li><a href="#shared-localization">Shared Localization</a></li>
<li><a href="#short-i18n">Short I18n</a></li>
<li><a href="#lazy-lookup">Lazy Lookup</a></li>
<li><a href="#dot-separated-keys">Dot-separated Keys</a></li>
<li><a href="#i18n-guides">I18n Guides</a></li>
</ul>
</li>
<li><a href="#assets">Assets</a>
<ul class="sectlevel2">
<li><a href="#reserve-app-assets">Reserve <code>app/assets</code></a></li>
<li><a href="#lib-assets"><code>lib/assets</code></a></li>
<li><a href="#vendor-assets"><code>vendor/assets</code></a></li>
<li><a href="#gem-assets"><code>gem/assets</code></a></li>
</ul>
</li>
<li><a href="#mailers">Mailers</a>
<ul class="sectlevel2">
<li><a href="#mailer-name">Mailer Name</a></li>
<li><a href="#html-plain-email">HTML Plain Email</a></li>
<li><a href="#enable-delivery-errors">Enable Delivery Errors</a></li>
<li><a href="#local-smtp">Local SMTP</a></li>
<li><a href="#default-hostname">Default Hostname</a></li>
<li><a href="#email-addresses">Email Addresses</a></li>
<li><a href="#delivery-method-test">Delivery Method Test</a></li>
<li><a href="#delivery-method-smtp">Delivery Method SMTP</a></li>
<li><a href="#inline-email-styles">Inline Email Styles</a></li>
<li><a href="#background-email">Background Email</a></li>
</ul>
</li>
<li><a href="#active-support-core-extensions">Active Support Core Extensions</a>
<ul class="sectlevel2">
<li><a href="#try-bang"><code>try!</code></a></li>
<li><a href="#active_support_aliases">Active Support Aliases</a></li>
<li><a href="#active_support_extensions">Active Support Extensions</a></li>
<li><a href="#inquiry"><code>inquiry</code></a></li>
<li><a href="#exclude"><code>exclude?</code></a></li>
<li><a href="#prefer-squiggly-heredoc">Prefer using squiggly heredoc over <code>strip_heredoc</code></a></li>
<li><a href="#prefer-to-fs">Prefer <code>to_fs</code> for Formatted Strings</a></li>
</ul>
</li>
<li><a href="#time">Time</a>
<ul class="sectlevel2">
<li><a href="#tz-config">Time Zone Config</a></li>
<li><a href="#time-parse"><code>Time.parse</code></a></li>
<li><a href="#to-time"><code>to_time</code></a></li>
<li><a href="#time-now"><code>Time.now</code></a></li>
<li><a href="#date-time-range">Prefer <code>all_(day|week|month|quarter|year)</code> over range of date/time</a></li>
</ul>
</li>
<li><a href="#duration">Duration</a>
<ul class="sectlevel2">
<li><a href="#duration-application">Duration Application</a></li>
<li><a href="#duration-arithmetic">Duration Arithmetic</a></li>
</ul>
</li>
<li><a href="#bundler">Bundler</a>
<ul class="sectlevel2">
<li><a href="#dev-test-gems">Dev/Test Gems</a></li>
<li><a href="#only-good-gems">Only Good Gems</a></li>
<li><a href="#gemfile-lock"><code>Gemfile.lock</code></a></li>
</ul>
</li>
<li><a href="#testing">Testing</a>
<ul class="sectlevel2">
<li><a href="#integration-testing">Integration Testing</a></li>
<li><a href="#freeze-time"><code>freeze_time</code></a></li>
</ul>
</li>
<li><a href="#managing-processes">Managing Processes</a>
<ul class="sectlevel2">
<li><a href="#foreman">Foreman</a></li>
</ul>
</li>
<li><a href="#further-reading">Further Reading</a></li>
<li><a href="#contributing">Contributing</a>
<ul class="sectlevel2">
<li><a href="#how-to-contribute">How to Contribute?</a></li>
</ul>
</li>
<li><a href="#license">License</a></li>
<li><a href="#spread-the-word">Spread the Word</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction"><a class="anchor" href="#introduction"></a><a class="link" href="#introduction">Introduction</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>By <a href="https://github.com/bbatsov">Bozhidar Batsov</a></p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Role models are important.</p>
</div>
<div class="paragraph">
<p>&#8201;&#8212;&#8201;Officer Alex J. Murphy / RoboCop</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The goal of this guide is to present a set of best practices and style prescriptions for Ruby on Rails development.
It&#8217;s a complementary guide to the already existing community-driven <a href="https://github.com/rubocop/ruby-style-guide">Ruby coding style guide</a>.</p>
</div>
<div class="paragraph">
<p>This Rails style guide recommends best practices so that real-world Rails programmers can write code that can be maintained by other real-world Rails programmers.
A style guide that reflects real-world usage gets used, and a style guide that holds to an ideal that has been rejected by the people it is supposed to help risks not getting used at all - no matter how good it is.</p>
</div>
<div class="paragraph">
<p>The guide is separated into several sections of related rules.
I&#8217;ve tried to add the rationale behind the rules (if it&#8217;s omitted I&#8217;ve assumed it&#8217;s pretty obvious).</p>
</div>
<div class="paragraph">
<p>I didn&#8217;t come up with all the rules out of nowhere - they are mostly based on my extensive career as a professional software engineer, feedback and suggestions from members of the Rails community and various highly regarded Rails programming resources.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Some of the advice here is applicable only to recent versions of Rails.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You can generate a PDF copy of this guide using <a href="https://asciidoctor.org/docs/asciidoctor-pdf/">AsciiDoctor PDF</a>, and an HTML copy <a href="https://asciidoctor.org/docs/convert-documents/#converting-a-document-to-html">with</a> <a href="https://asciidoctor.org/#installation">AsciiDoctor</a> using the following commands:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell"><span class="c"># Generates README.pdf</span>
asciidoctor-pdf <span class="nt">-a</span> allow-uri-read README.adoc

<span class="c"># Generates README.html</span>
asciidoctor README.adoc</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>Install the <code>rouge</code> gem to get nice syntax highlighting in the generated document.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="shell">gem <span class="nb">install </span>rouge</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Translations of the guide are available in the following languages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://github.com/satour/rails-style-guide/blob/master/README-jaJA.md">Japanese</a></p>
</li>
<li>
<p><a href="https://github.com/arbox/rails-style-guide/blob/master/README-ruRU.md">Russian</a></p>
</li>
</ul>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<a href="https://github.com/rubocop/rubocop">RuboCop</a>, a static code analyzer (linter) and formatter, has a <a href="https://github.com/rubocop/rubocop-rails"><code>rubocop-rails</code></a> extension, based on this style guide.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="configuration"><a class="anchor" href="#configuration"></a><a class="link" href="#configuration">Configuration</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="config-initializers"><a class="anchor" href="#config-initializers"></a><a class="link" href="#config-initializers">Config Initializers</a></h3>
<div class="paragraph">
<p>Put custom initialization code in <code>config/initializers</code>.
The code in initializers executes on application startup.</p>
</div>
</div>
<div class="sect2">
<h3 id="gem-initializers"><a class="anchor" href="#gem-initializers"></a><a class="link" href="#gem-initializers">Gem Initializers</a></h3>
<div class="paragraph">
<p>Keep initialization code for each gem in a separate file with the same name as the gem, for example <code>carrierwave.rb</code>, <code>active_admin.rb</code>, etc.</p>
</div>
</div>
<div class="sect2">
<h3 id="dev-test-prod-configs"><a class="anchor" href="#dev-test-prod-configs"></a><a class="link" href="#dev-test-prod-configs">Dev/Test/Prod Configs</a></h3>
<div class="paragraph">
<p>Adjust accordingly the settings for development, test and production environment (in the corresponding files under <code>config/environments/</code>)</p>
</div>
<div class="paragraph">
<p>Mark additional assets for precompilation (if any):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># config/environments/production.rb</span>
<span class="c1"># Precompile additional assets (application.js, application.css,</span>
<span class="c1">#and all non-JS/CSS are already added)</span>
<span class="n">config</span><span class="p">.</span><span class="nf">assets</span><span class="p">.</span><span class="nf">precompile</span> <span class="o">+=</span> <span class="sx">%w( rails_admin/rails_admin.css rails_admin/rails_admin.js )</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="app-config"><a class="anchor" href="#app-config"></a><a class="link" href="#app-config">App Config</a></h3>
<div class="paragraph">
<p>Keep configuration that&#8217;s applicable to all environments in the <code>config/application.rb</code> file.</p>
</div>
</div>
<div class="sect2">
<h3 id="config-defaults"><a class="anchor" href="#config-defaults"></a><a class="link" href="#config-defaults">Load Rails Config Defaults</a></h3>
<div class="paragraph">
<p>When upgrading to a newer Rails version, your application&#8217;s configuration setting will remain on the previous version. To take advantage of the latest recommended Rails practices, the <code>config.load_defaults</code> setting should match your Rails version.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># good</span>
<span class="n">config</span><span class="p">.</span><span class="nf">load_defaults</span> <span class="mf">6.1</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="staging-like-prod"><a class="anchor" href="#staging-like-prod"></a><a class="link" href="#staging-like-prod">Staging Like Prod</a></h3>
<div class="paragraph">
<p>Avoid creating additional environment configurations than the defaults of <code>development</code>, <code>test</code> and <code>production</code>.
If you need a production-like environment such as staging, use environment variables for configuration options.</p>
</div>
</div>
<div class="sect2">
<h3 id="yaml-config"><a class="anchor" href="#yaml-config"></a><a class="link" href="#yaml-config">YAML Config</a></h3>
<div class="paragraph">
<p>Keep any additional configuration in YAML files under the <code>config/</code> directory.</p>
</div>
<div class="paragraph">
<p>Since Rails 4.2 YAML configuration files can be easily loaded with the new <code>config_for</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">Rails</span><span class="o">::</span><span class="no">Application</span><span class="p">.</span><span class="nf">config_for</span><span class="p">(</span><span class="ss">:yaml_file</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="routing"><a class="anchor" href="#routing"></a><a class="link" href="#routing">Routing</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="member-collection-routes"><a class="anchor" href="#member-collection-routes"></a><a class="link" href="#member-collection-routes">Member Collection Routes</a></h3>
<div class="paragraph">
<p>When you need to add more actions to a RESTful resource (do you really need them at all?) use <code>member</code> and <code>collection</code> routes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">get</span> <span class="s1">'subscriptions/:id/unsubscribe'</span>
<span class="n">resources</span> <span class="ss">:subscriptions</span>

<span class="c1"># good</span>
<span class="n">resources</span> <span class="ss">:subscriptions</span> <span class="k">do</span>
  <span class="n">get</span> <span class="s1">'unsubscribe'</span><span class="p">,</span> <span class="ss">on: :member</span>
<span class="k">end</span>

<span class="c1"># bad</span>
<span class="n">get</span> <span class="s1">'photos/search'</span>
<span class="n">resources</span> <span class="ss">:photos</span>

<span class="c1"># good</span>
<span class="n">resources</span> <span class="ss">:photos</span> <span class="k">do</span>
  <span class="n">get</span> <span class="s1">'search'</span><span class="p">,</span> <span class="ss">on: :collection</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="many-member-collection-routes"><a class="anchor" href="#many-member-collection-routes"></a><a class="link" href="#many-member-collection-routes">Many Member Collection Routes</a></h3>
<div class="paragraph">
<p>If you need to define multiple <code>member/collection</code> routes use the alternative block syntax.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">resources</span> <span class="ss">:subscriptions</span> <span class="k">do</span>
  <span class="n">member</span> <span class="k">do</span>
    <span class="n">get</span> <span class="s1">'unsubscribe'</span>
    <span class="c1"># more routes</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="n">resources</span> <span class="ss">:photos</span> <span class="k">do</span>
  <span class="n">collection</span> <span class="k">do</span>
    <span class="n">get</span> <span class="s1">'search'</span>
    <span class="c1"># more routes</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="nested-routes"><a class="anchor" href="#nested-routes"></a><a class="link" href="#nested-routes">Nested Routes</a></h3>
<div class="paragraph">
<p>Use nested routes to express better the relationship between Active Record models.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Post</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:comments</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Comment</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">belongs_to</span> <span class="ss">:post</span>
<span class="k">end</span>

<span class="c1"># routes.rb</span>
<span class="n">resources</span> <span class="ss">:posts</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:comments</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="shallow-routes"><a class="anchor" href="#shallow-routes"></a><a class="link" href="#shallow-routes">Shallow Routes</a></h3>
<div class="paragraph">
<p>If you need to nest routes more than 1 level deep then use the <code>shallow: true</code> option.
This will save user from long URLs <code>posts/1/comments/5/versions/7/edit</code> and you from long URL helpers <code>edit_post_comment_version</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">resources</span> <span class="ss">:posts</span><span class="p">,</span> <span class="ss">shallow: </span><span class="kp">true</span> <span class="k">do</span>
  <span class="n">resources</span> <span class="ss">:comments</span> <span class="k">do</span>
    <span class="n">resources</span> <span class="ss">:versions</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="namespaced-routes"><a class="anchor" href="#namespaced-routes"></a><a class="link" href="#namespaced-routes">Namespaced Routes</a></h3>
<div class="paragraph">
<p>Use namespaced routes to group related actions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">namespace</span> <span class="ss">:admin</span> <span class="k">do</span>
  <span class="c1"># Directs /admin/products/* to Admin::ProductsController</span>
  <span class="c1"># (app/controllers/admin/products_controller.rb)</span>
  <span class="n">resources</span> <span class="ss">:products</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-wild-routes"><a class="anchor" href="#no-wild-routes"></a><a class="link" href="#no-wild-routes">No Wild Routes</a></h3>
<div class="paragraph">
<p>Never use the legacy wild controller route.
This route will make all actions in every controller accessible via GET requests.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># very bad</span>
<span class="n">match</span> <span class="s1">':controller(/:action(/:id(.:format)))'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="no-match-routes"><a class="anchor" href="#no-match-routes"></a><a class="link" href="#no-match-routes">No Match Routes</a></h3>
<div class="paragraph">
<p>Don&#8217;t use <code>match</code> to define any routes unless there is need to map multiple request types among <code>[:get, :post, :patch, :put, :delete]</code> to a single action using <code>:via</code> option.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="controllers"><a class="anchor" href="#controllers"></a><a class="link" href="#controllers">Controllers</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="skinny-controllers"><a class="anchor" href="#skinny-controllers"></a><a class="link" href="#skinny-controllers">Skinny Controllers</a></h3>
<div class="paragraph">
<p>Keep the controllers skinny - they should only retrieve data for the view layer and shouldn&#8217;t contain any business logic (all the business logic should naturally reside in the model).</p>
</div>
</div>
<div class="sect2">
<h3 id="one-method"><a class="anchor" href="#one-method"></a><a class="link" href="#one-method">One Method</a></h3>
<div class="paragraph">
<p>Each controller action should (ideally) invoke only one method other than an initial find or new.</p>
</div>
</div>
<div class="sect2">
<h3 id="shared-instance-variables"><a class="anchor" href="#shared-instance-variables"></a><a class="link" href="#shared-instance-variables">Shared Instance Variables</a></h3>
<div class="paragraph">
<p>Minimize the number of instance variables passed between a controller and a view.</p>
</div>
</div>
<div class="sect2">
<h3 id="lexically-scoped-action-filter"><a class="anchor" href="#lexically-scoped-action-filter"></a><a class="link" href="#lexically-scoped-action-filter">Lexically Scoped Action Filter</a></h3>
<div class="paragraph">
<p>Controller actions specified in the option of Action Filter should be in lexical scope.
The ActionFilter specified for an inherited action makes it difficult to understand the scope of its impact on that action.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">before_action</span> <span class="ss">:require_login</span><span class="p">,</span> <span class="ss">only: :export</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="n">before_action</span> <span class="ss">:require_login</span><span class="p">,</span> <span class="ss">only: :export</span>

  <span class="k">def</span> <span class="nf">export</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rendering"><a class="anchor" href="#rendering"></a><a class="link" href="#rendering">Controllers: Rendering</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="inline-rendering"><a class="anchor" href="#inline-rendering"></a><a class="link" href="#inline-rendering">Inline Rendering</a></h3>
<div class="paragraph">
<p>Prefer using a template over inline rendering.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># very bad</span>
<span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="k">def</span> <span class="nf">index</span>
    <span class="n">render</span> <span class="ss">inline: </span><span class="s2">"&lt;% products.each do |p| %&gt;&lt;p&gt;&lt;%= p.name %&gt;&lt;/p&gt;&lt;% end %&gt;"</span><span class="p">,</span> <span class="ss">type: :erb</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="c1">## app/views/products/index.html.erb</span>
<span class="o">&lt;</span><span class="sx">%= render partial: 'product', collection: products %&gt;

## app/views/products/_product.html.erb
&lt;p&gt;&lt;%=</span> <span class="n">product</span><span class="p">.</span><span class="nf">name</span> <span class="sx">%&gt;&lt;/p&gt;</span>
<span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;&lt;</span><span class="sx">%= product.price %&gt;&lt;/p&gt;

## app/controllers/products_controller.rb
class ProductsController &lt; ApplicationController
  def index
    render :index
  end
end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="plain-text-rendering"><a class="anchor" href="#plain-text-rendering"></a><a class="link" href="#plain-text-rendering">Plain Text Rendering</a></h3>
<div class="paragraph">
<p>Prefer <code>render plain:</code> over <code>render text:</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - sets MIME type to `text/html`</span>
<span class="o">...</span>
<span class="n">render</span> <span class="ss">text: </span><span class="s1">'Ruby!'</span>
<span class="o">...</span>

<span class="c1"># bad - requires explicit MIME type declaration</span>
<span class="o">...</span>
<span class="n">render</span> <span class="ss">text: </span><span class="s1">'Ruby!'</span><span class="p">,</span> <span class="ss">content_type: </span><span class="s1">'text/plain'</span>
<span class="o">...</span>

<span class="c1"># good - short and precise</span>
<span class="o">...</span>
<span class="n">render</span> <span class="ss">plain: </span><span class="s1">'Ruby!'</span>
<span class="o">...</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="http-status-code-symbols"><a class="anchor" href="#http-status-code-symbols"></a><a class="link" href="#http-status-code-symbols">HTTP Status Code Symbols</a></h3>
<div class="paragraph">
<p>Prefer <a href="https://gist.github.com/mlanett/a31c340b132ddefa9cca">corresponding symbols</a> to numeric HTTP status codes.
They are meaningful and do not look like "magic" numbers for less known HTTP status codes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="o">...</span>
<span class="n">render</span> <span class="ss">status: </span><span class="mi">403</span>
<span class="o">...</span>

<span class="c1"># good</span>
<span class="o">...</span>
<span class="n">render</span> <span class="ss">status: :forbidden</span>
<span class="o">...</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="models"><a class="anchor" href="#models"></a><a class="link" href="#models">Models</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="model-classes"><a class="anchor" href="#model-classes"></a><a class="link" href="#model-classes">Model Classes</a></h3>
<div class="paragraph">
<p>Introduce non-Active Record model classes freely.</p>
</div>
</div>
<div class="sect2">
<h3 id="meaningful-model-names"><a class="anchor" href="#meaningful-model-names"></a><a class="link" href="#meaningful-model-names">Meaningful Model Names</a></h3>
<div class="paragraph">
<p>Name the models with meaningful (but short) names without abbreviations.</p>
</div>
</div>
<div class="sect2">
<h3 id="non-activerecord-models"><a class="anchor" href="#non-activerecord-models"></a><a class="link" href="#non-activerecord-models">Non-ActiveRecord Models</a></h3>
<div class="paragraph">
<p>If you need objects that support ActiveRecord-like behavior (like validations) without the database functionality, use <code>ActiveModel::Model</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Message</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Model</span>

  <span class="nb">attr_accessor</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:content</span><span class="p">,</span> <span class="ss">:priority</span>

  <span class="n">validates</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span>
  <span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">format: </span><span class="p">{</span> <span class="ss">with: </span><span class="sr">/\A[-a-z0-9_+\.]+\@([-a-z0-9]+\.)+[a-z0-9]{2,4}\z/i</span> <span class="p">}</span>
  <span class="n">validates</span> <span class="ss">:content</span><span class="p">,</span> <span class="ss">length: </span><span class="p">{</span> <span class="ss">maximum: </span><span class="mi">500</span> <span class="p">}</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Starting with Rails 6.1, you can also extend the attributes API from ActiveRecord using <code>ActiveModel::Attributes</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Message</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Model</span>
  <span class="kp">include</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">Attributes</span>

  <span class="n">attribute</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:string</span>
  <span class="n">attribute</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:string</span>
  <span class="n">attribute</span> <span class="ss">:content</span><span class="p">,</span> <span class="ss">:string</span>
  <span class="n">attribute</span> <span class="ss">:priority</span><span class="p">,</span> <span class="ss">:integer</span>

  <span class="n">validates</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span>
  <span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">format: </span><span class="p">{</span> <span class="ss">with: </span><span class="sr">/\A[-a-z0-9_+\.]+\@([-a-z0-9]+\.)+[a-z0-9]{2,4}\z/i</span> <span class="p">}</span>
  <span class="n">validates</span> <span class="ss">:content</span><span class="p">,</span> <span class="ss">length: </span><span class="p">{</span> <span class="ss">maximum: </span><span class="mi">500</span> <span class="p">}</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="model-business-logic"><a class="anchor" href="#model-business-logic"></a><a class="link" href="#model-business-logic">Model Business Logic</a></h3>
<div class="paragraph">
<p>Unless they have some meaning in the business domain, don&#8217;t put methods in your model that just format your data (like code generating HTML).
These methods are most likely going to be called from the view layer only, so their place is in helpers.
Keep your models for business logic and data-persistence only.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="activerecord"><a class="anchor" href="#activerecord"></a><a class="link" href="#activerecord">Models: Active Record</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="keep-ar-defaults"><a class="anchor" href="#keep-ar-defaults"></a><a class="link" href="#keep-ar-defaults">Keep Active Record Defaults</a></h3>
<div class="paragraph">
<p>Avoid altering Active Record defaults (table names, primary key, etc) unless you have a very good reason (like a database that&#8217;s not under your control).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - don't do this if you can modify the schema</span>
<span class="k">class</span> <span class="nc">Transaction</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">table_name</span> <span class="o">=</span> <span class="s1">'order'</span>
  <span class="o">...</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="append-ignored-columns"><a class="anchor" href="#append-ignored-columns"></a><a class="link" href="#append-ignored-columns">Always append to <code>ignored_columns</code></a></h3>
<div class="paragraph">
<p>Avoid setting <code>ignored_columns</code>. It may overwrite previous assignments and that is almost always a mistake. Prefer appending to the list instead.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Transaction</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="c1"># bad - it may overwrite previous assignments</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">ignored_columns</span> <span class="o">=</span> <span class="sx">%i[legacy]</span>

  <span class="c1"># good - the value is appended to the list</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">ignored_columns</span> <span class="o">+=</span> <span class="sx">%i[legacy]</span>
  <span class="o">...</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="enums"><a class="anchor" href="#enums"></a><a class="link" href="#enums">Enums</a></h3>
<div class="paragraph">
<p>Prefer using the hash syntax for <code>enum</code>. Array makes the database values implicit
&amp; any insertion/removal/rearrangement of values in the middle will most probably
lead to broken code.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Transaction</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="c1"># bad - implicit values - ordering matters</span>
  <span class="n">enum</span> <span class="ss">:type</span><span class="p">,</span> <span class="sx">%i[credit debit]</span>

  <span class="c1"># good - explicit values - ordering does not matter</span>
  <span class="n">enum</span> <span class="ss">:type</span><span class="p">,</span> <span class="p">{</span>
    <span class="ss">credit: </span><span class="mi">0</span><span class="p">,</span>
    <span class="ss">debit: </span><span class="mi">1</span>
  <span class="p">}</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="macro-style-methods"><a class="anchor" href="#macro-style-methods"></a><a class="link" href="#macro-style-methods">Macro Style Methods</a></h3>
<div class="paragraph">
<p>Group macro-style methods (<code>has_many</code>, <code>validates</code>, etc) in the beginning of the class definition.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="c1"># keep the default scope first (if any)</span>
  <span class="n">default_scope</span> <span class="p">{</span> <span class="n">where</span><span class="p">(</span><span class="ss">active: </span><span class="kp">true</span><span class="p">)</span> <span class="p">}</span>

  <span class="c1"># constants come up next</span>
  <span class="no">COLORS</span> <span class="o">=</span> <span class="sx">%w(red green blue)</span>

  <span class="c1"># afterwards we put attr related macros</span>
  <span class="nb">attr_accessor</span> <span class="ss">:formatted_date_of_birth</span>

  <span class="n">attr_accessible</span> <span class="ss">:login</span><span class="p">,</span> <span class="ss">:first_name</span><span class="p">,</span> <span class="ss">:last_name</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:password</span>

  <span class="c1"># Rails 4+ enums after attr macros</span>
  <span class="n">enum</span> <span class="ss">role: </span><span class="p">{</span> <span class="ss">user: </span><span class="mi">0</span><span class="p">,</span> <span class="ss">moderator: </span><span class="mi">1</span><span class="p">,</span> <span class="ss">admin: </span><span class="mi">2</span> <span class="p">}</span>

  <span class="c1"># followed by association macros</span>
  <span class="n">belongs_to</span> <span class="ss">:country</span>

  <span class="n">has_many</span> <span class="ss">:authentications</span><span class="p">,</span> <span class="ss">dependent: :destroy</span>

  <span class="c1"># and validation macros</span>
  <span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span>
  <span class="n">validates</span> <span class="ss">:username</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span>
  <span class="n">validates</span> <span class="ss">:username</span><span class="p">,</span> <span class="ss">uniqueness: </span><span class="p">{</span> <span class="ss">case_sensitive: </span><span class="kp">false</span> <span class="p">}</span>
  <span class="n">validates</span> <span class="ss">:username</span><span class="p">,</span> <span class="ss">format: </span><span class="p">{</span> <span class="ss">with: </span><span class="sr">/\A[A-Za-z][A-Za-z0-9._-]{2,19}\z/</span> <span class="p">}</span>
  <span class="n">validates</span> <span class="ss">:password</span><span class="p">,</span> <span class="ss">format: </span><span class="p">{</span> <span class="ss">with: </span><span class="sr">/\A\S{8,128}\z/</span><span class="p">,</span> <span class="ss">allow_nil: </span><span class="kp">true</span> <span class="p">}</span>

  <span class="c1"># next we have callbacks</span>
  <span class="n">before_save</span> <span class="ss">:cook</span>
  <span class="n">before_save</span> <span class="ss">:update_username_lower</span>

  <span class="c1"># other macros (like devise's) should be placed after the callbacks</span>

  <span class="o">...</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="has-many-through"><a class="anchor" href="#has-many-through"></a><a class="link" href="#has-many-through"><code>has_many :through</code></a></h3>
<div class="paragraph">
<p>Prefer <code>has_many :through</code> to <code>has_and_belongs_to_many</code>.
Using <code>has_many :through</code> allows additional attributes and validations on the join model.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># not so good - using has_and_belongs_to_many</span>
<span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_and_belongs_to_many</span> <span class="ss">:groups</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Group</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_and_belongs_to_many</span> <span class="ss">:users</span>
<span class="k">end</span>

<span class="c1"># preferred way - using has_many :through</span>
<span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:memberships</span>
  <span class="n">has_many</span> <span class="ss">:groups</span><span class="p">,</span> <span class="ss">through: :memberships</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Membership</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">belongs_to</span> <span class="ss">:user</span>
  <span class="n">belongs_to</span> <span class="ss">:group</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Group</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:memberships</span>
  <span class="n">has_many</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">through: :memberships</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="read-attribute"><a class="anchor" href="#read-attribute"></a><a class="link" href="#read-attribute">Read Attribute</a></h3>
<div class="paragraph">
<p>Prefer <code>self[:attribute]</code> over <code>read_attribute(:attribute)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">amount</span>
  <span class="n">read_attribute</span><span class="p">(</span><span class="ss">:amount</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">amount</span>
  <span class="nb">self</span><span class="p">[</span><span class="ss">:amount</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="write-attribute"><a class="anchor" href="#write-attribute"></a><a class="link" href="#write-attribute">Write Attribute</a></h3>
<div class="paragraph">
<p>Prefer <code>self[:attribute] = value</code> over <code>write_attribute(:attribute, value)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">def</span> <span class="nf">amount</span>
  <span class="n">write_attribute</span><span class="p">(</span><span class="ss">:amount</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">def</span> <span class="nf">amount</span>
  <span class="nb">self</span><span class="p">[</span><span class="ss">:amount</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="new-style-validations"><a class="anchor" href="#new-style-validations"></a><a class="link" href="#new-style-validations">New-style Validations</a></h3>
<div class="paragraph">
<p>Always use the <a href="http://thelucid.com/2010/01/08/sexy-validation-in-edge-rails-rails-3/">"new-style" validations</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">validates_presence_of</span> <span class="ss">:email</span>
<span class="n">validates_length_of</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">maximum: </span><span class="mi">100</span>

<span class="c1"># good</span>
<span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span><span class="p">,</span> <span class="ss">length: </span><span class="p">{</span> <span class="ss">maximum: </span><span class="mi">100</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="custom-validation-methods"><a class="anchor" href="#custom-validation-methods"></a><a class="link" href="#custom-validation-methods">Custom Validation Methods</a></h3>
<div class="paragraph">
<p>When naming custom validation methods, adhere to the simple rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>validate :method_name</code> reads like a natural statement</p>
</li>
<li>
<p>the method name explains what it checks</p>
</li>
<li>
<p>the method is recognizable as a validation method by its name, not a predicate method</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># good</span>
<span class="n">validate</span> <span class="ss">:expiration_date_cannot_be_in_the_past</span>
<span class="n">validate</span> <span class="ss">:discount_cannot_be_greater_than_total_value</span>
<span class="n">validate</span> <span class="ss">:ensure_same_topic_is_chosen</span>

<span class="c1"># also good - explicit prefix</span>
<span class="n">validate</span> <span class="ss">:validate_birthday_in_past</span>
<span class="n">validate</span> <span class="ss">:validate_sufficient_quantity</span>
<span class="n">validate</span> <span class="ss">:must_have_owner_with_no_other_items</span>
<span class="n">validate</span> <span class="ss">:must_have_shipping_units</span>

<span class="c1"># bad</span>
<span class="n">validate</span> <span class="ss">:birthday_in_past</span>
<span class="n">validate</span> <span class="ss">:owner_has_no_other_items</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="single-attribute-validations"><a class="anchor" href="#single-attribute-validations"></a><a class="link" href="#single-attribute-validations">Single-attribute Validations</a></h3>
<div class="paragraph">
<p>To make validations easy to read, don&#8217;t list multiple attributes per validation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:password</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span>
<span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">length: </span><span class="p">{</span> <span class="ss">maximum: </span><span class="mi">100</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span><span class="p">,</span> <span class="ss">length: </span><span class="p">{</span> <span class="ss">maximum: </span><span class="mi">100</span> <span class="p">}</span>
<span class="n">validates</span> <span class="ss">:password</span><span class="p">,</span> <span class="ss">presence: </span><span class="kp">true</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="custom-validator-file"><a class="anchor" href="#custom-validator-file"></a><a class="link" href="#custom-validator-file">Custom Validator File</a></h3>
<div class="paragraph">
<p>When a custom validation is used more than once or the validation is some regular expression mapping, create a custom validator file.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">format: </span><span class="p">{</span> <span class="ss">with: </span><span class="sr">/\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\z/i</span> <span class="p">}</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">EmailValidator</span> <span class="o">&lt;</span> <span class="no">ActiveModel</span><span class="o">::</span><span class="no">EachValidator</span>
  <span class="k">def</span> <span class="nf">validate_each</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
    <span class="n">record</span><span class="p">.</span><span class="nf">errors</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">options</span><span class="p">[</span><span class="ss">:message</span><span class="p">]</span> <span class="o">||</span> <span class="s1">'is not a valid email'</span><span class="p">)</span> <span class="k">unless</span> <span class="n">value</span> <span class="o">=~</span> <span class="sr">/\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\z/i</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">Person</span>
  <span class="n">validates</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">email: </span><span class="kp">true</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="app-validators"><a class="anchor" href="#app-validators"></a><a class="link" href="#app-validators">App Validators</a></h3>
<div class="paragraph">
<p>Keep custom validators under <code>app/validators</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="custom-validators-gem"><a class="anchor" href="#custom-validators-gem"></a><a class="link" href="#custom-validators-gem">Custom Validators Gem</a></h3>
<div class="paragraph">
<p>Consider extracting custom validators to a shared gem if you&#8217;re maintaining several related apps or the validators are generic enough.</p>
</div>
</div>
<div class="sect2">
<h3 id="named-scopes"><a class="anchor" href="#named-scopes"></a><a class="link" href="#named-scopes">Named Scopes</a></h3>
<div class="paragraph">
<p>Use named scopes freely.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">scope</span> <span class="ss">:active</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="n">where</span><span class="p">(</span><span class="ss">active: </span><span class="kp">true</span><span class="p">)</span> <span class="p">}</span>
  <span class="n">scope</span> <span class="ss">:inactive</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="n">where</span><span class="p">(</span><span class="ss">active: </span><span class="kp">false</span><span class="p">)</span> <span class="p">}</span>

  <span class="n">scope</span> <span class="ss">:with_orders</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="n">joins</span><span class="p">(</span><span class="ss">:orders</span><span class="p">).</span><span class="nf">select</span><span class="p">(</span><span class="s1">'distinct(users.id)'</span><span class="p">)</span> <span class="p">}</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="named-scope-class"><a class="anchor" href="#named-scope-class"></a><a class="link" href="#named-scope-class">Named Scope Class</a></h3>
<div class="paragraph">
<p>When a named scope defined with a lambda and parameters becomes too complicated, it is preferable to make a class method instead which serves the same purpose of the named scope and returns an <code>ActiveRecord::Relation</code> object.
Arguably you can define even simpler scopes like this.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">with_orders</span>
    <span class="n">joins</span><span class="p">(</span><span class="ss">:orders</span><span class="p">).</span><span class="nf">select</span><span class="p">(</span><span class="s1">'distinct(users.id)'</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="callbacks-order"><a class="anchor" href="#callbacks-order"></a><a class="link" href="#callbacks-order">Callbacks Order</a></h3>
<div class="paragraph">
<p>Order callback declarations in the order in which they will be executed.
For reference, see <a href="https://guides.rubyonrails.org/active_record_callbacks.html#available-callbacks">Available Callbacks</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="n">after_commit</span> <span class="ss">:after_commit_callback</span>
  <span class="n">before_validation</span> <span class="ss">:before_validation_callback</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Person</span>
  <span class="n">before_validation</span> <span class="ss">:before_validation_callback</span>
  <span class="n">after_commit</span> <span class="ss">:after_commit_callback</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="beware-skip-model-validations"><a class="anchor" href="#beware-skip-model-validations"></a><a class="link" href="#beware-skip-model-validations">Beware Skip Model Validations</a></h3>
<div class="paragraph">
<p>Beware of the behavior of the <a href="https://guides.rubyonrails.org/active_record_validations.html#skipping-validations">following</a> methods.
They do not run the model validations and could easily corrupt the model state.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Article</span><span class="p">.</span><span class="nf">first</span><span class="p">.</span><span class="nf">decrement!</span><span class="p">(</span><span class="ss">:view_count</span><span class="p">)</span>
<span class="no">DiscussionBoard</span><span class="p">.</span><span class="nf">decrement_counter</span><span class="p">(</span><span class="ss">:post_count</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="no">Article</span><span class="p">.</span><span class="nf">first</span><span class="p">.</span><span class="nf">increment!</span><span class="p">(</span><span class="ss">:view_count</span><span class="p">)</span>
<span class="no">DiscussionBoard</span><span class="p">.</span><span class="nf">increment_counter</span><span class="p">(</span><span class="ss">:post_count</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">person</span><span class="p">.</span><span class="nf">toggle</span> <span class="ss">:active</span>
<span class="n">product</span><span class="p">.</span><span class="nf">touch</span>
<span class="no">Billing</span><span class="p">.</span><span class="nf">update_all</span><span class="p">(</span><span class="s2">"category = 'authorized', author = 'David'"</span><span class="p">)</span>
<span class="n">user</span><span class="p">.</span><span class="nf">update_attribute</span><span class="p">(</span><span class="ss">:website</span><span class="p">,</span> <span class="s1">'example.com'</span><span class="p">)</span>
<span class="n">user</span><span class="p">.</span><span class="nf">update_columns</span><span class="p">(</span><span class="ss">last_request_at: </span><span class="no">Time</span><span class="p">.</span><span class="nf">current</span><span class="p">)</span>
<span class="no">Post</span><span class="p">.</span><span class="nf">update_counters</span> <span class="mi">5</span><span class="p">,</span> <span class="ss">comment_count: </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="ss">action_count: </span><span class="mi">1</span>

<span class="c1"># good</span>
<span class="n">user</span><span class="p">.</span><span class="nf">update_attributes</span><span class="p">(</span><span class="ss">website: </span><span class="s1">'example.com'</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="user-friendly-urls"><a class="anchor" href="#user-friendly-urls"></a><a class="link" href="#user-friendly-urls">User-friendly URLs</a></h3>
<div class="paragraph">
<p>Use user-friendly URLs.
Show some descriptive attribute of the model in the URL rather than its <code>id</code>.
There is more than one way to achieve this.</p>
</div>
<div class="sect3">
<h4 id="override-the-to_param-method-of-the-model"><a class="anchor" href="#override-the-to_param-method-of-the-model"></a><a class="link" href="#override-the-to_param-method-of-the-model">Override the <code>to_param</code> Method of the Model</a></h4>
<div class="paragraph">
<p>This method is used by Rails for constructing a URL to the object.
The default implementation returns the <code>id</code> of the record as a String.
It could be overridden to include another human-readable attribute.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Person</span>
  <span class="k">def</span> <span class="nf">to_param</span>
    <span class="s2">"</span><span class="si">#{</span><span class="nb">id</span><span class="si">}</span><span class="s2"> </span><span class="si">#{</span><span class="nb">name</span><span class="si">}</span><span class="s2">"</span><span class="p">.</span><span class="nf">parameterize</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In order to convert this to a URL-friendly value, <code>parameterize</code> should be called on the string.
The <code>id</code> of the object needs to be at the beginning so that it can be found by the <code>find</code> method of Active Record.</p>
</div>
</div>
<div class="sect3">
<h4 id="friendly_id-gem"><a class="anchor" href="#friendly_id-gem"></a><a class="link" href="#friendly_id-gem"><code>friendly_id</code> Gem</a></h4>
<div class="paragraph">
<p>It allows creation of human-readable URLs by using some descriptive attribute of the model instead of its <code>id</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="k">class</span> <span class="nc">Person</span>
  <span class="kp">extend</span> <span class="no">FriendlyId</span>
  <span class="n">friendly_id</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">use: :slugged</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the <a href="https://github.com/norman/friendly_id">gem documentation</a> for more information about its usage.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="find-each"><a class="anchor" href="#find-each"></a><a class="link" href="#find-each"><code>find_each</code></a></h3>
<div class="paragraph">
<p>Use <code>find_each</code> to iterate over a collection of AR objects.
Looping through a collection of records from the database (using the <code>all</code> method, for example) is very inefficient since it will try to instantiate all the objects at once.
In that case, batch processing methods allow you to work with the records in batches, thereby greatly reducing memory consumption.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Person</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">person</span><span class="o">|</span>
  <span class="n">person</span><span class="p">.</span><span class="nf">do_awesome_stuff</span>
<span class="k">end</span>

<span class="no">Person</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s1">'age &gt; 21'</span><span class="p">).</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">person</span><span class="o">|</span>
  <span class="n">person</span><span class="p">.</span><span class="nf">party_all_night!</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="no">Person</span><span class="p">.</span><span class="nf">find_each</span> <span class="k">do</span> <span class="o">|</span><span class="n">person</span><span class="o">|</span>
  <span class="n">person</span><span class="p">.</span><span class="nf">do_awesome_stuff</span>
<span class="k">end</span>

<span class="no">Person</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s1">'age &gt; 21'</span><span class="p">).</span><span class="nf">find_each</span> <span class="k">do</span> <span class="o">|</span><span class="n">person</span><span class="o">|</span>
  <span class="n">person</span><span class="p">.</span><span class="nf">party_all_night!</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="before_destroy"><a class="anchor" href="#before_destroy"></a><a class="link" href="#before_destroy"><code>before_destroy</code></a></h3>
<div class="paragraph">
<p>Since <a href="https://github.com/rails/rails/issues/3458">Rails creates callbacks for dependent associations</a>, always call <code>before_destroy</code> callbacks that perform validation with <code>prepend: true</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad (roles will be deleted automatically even if super_admin? is true)</span>
<span class="n">has_many</span> <span class="ss">:roles</span><span class="p">,</span> <span class="ss">dependent: :destroy</span>

<span class="n">before_destroy</span> <span class="ss">:ensure_deletable</span>

<span class="k">def</span> <span class="nf">ensure_deletable</span>
  <span class="k">raise</span> <span class="s2">"Cannot delete super admin."</span> <span class="k">if</span> <span class="n">super_admin?</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">has_many</span> <span class="ss">:roles</span><span class="p">,</span> <span class="ss">dependent: :destroy</span>

<span class="n">before_destroy</span> <span class="ss">:ensure_deletable</span><span class="p">,</span> <span class="ss">prepend: </span><span class="kp">true</span>

<span class="k">def</span> <span class="nf">ensure_deletable</span>
  <span class="k">raise</span> <span class="s2">"Cannot delete super admin."</span> <span class="k">if</span> <span class="n">super_admin?</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="has_many-has_one-dependent-option"><a class="anchor" href="#has_many-has_one-dependent-option"></a><a class="link" href="#has_many-has_one-dependent-option"><code>has_many</code>/<code>has_one</code> Dependent Option</a></h3>
<div class="paragraph">
<p>Define the <code>dependent</code> option to the <code>has_many</code> and <code>has_one</code> associations.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">Post</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:comments</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">Post</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="n">has_many</span> <span class="ss">:comments</span><span class="p">,</span> <span class="ss">dependent: :destroy</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="save-bang"><a class="anchor" href="#save-bang"></a><a class="link" href="#save-bang"><code>save!</code></a></h3>
<div class="paragraph">
<p>When persisting AR objects always use the exception raising bang! method or handle the method return value.
This applies to <code>create</code>, <code>save</code>, <code>update</code>, <code>destroy</code>, <code>first_or_create</code> and <code>find_or_create_by</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">user</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">name: </span><span class="s1">'Bruce'</span><span class="p">)</span>

<span class="c1"># bad</span>
<span class="n">user</span><span class="p">.</span><span class="nf">save</span>

<span class="c1"># good</span>
<span class="n">user</span><span class="p">.</span><span class="nf">create!</span><span class="p">(</span><span class="ss">name: </span><span class="s1">'Bruce'</span><span class="p">)</span>
<span class="c1"># or</span>
<span class="n">bruce</span> <span class="o">=</span> <span class="n">user</span><span class="p">.</span><span class="nf">create</span><span class="p">(</span><span class="ss">name: </span><span class="s1">'Bruce'</span><span class="p">)</span>
<span class="k">if</span> <span class="n">bruce</span><span class="p">.</span><span class="nf">persisted?</span>
  <span class="o">...</span>
<span class="k">else</span>
  <span class="o">...</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">user</span><span class="p">.</span><span class="nf">save!</span>
<span class="c1"># or</span>
<span class="k">if</span> <span class="n">user</span><span class="p">.</span><span class="nf">save</span>
  <span class="o">...</span>
<span class="k">else</span>
  <span class="o">...</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="activerecord-queries"><a class="anchor" href="#activerecord-queries"></a><a class="link" href="#activerecord-queries">Models: Active Record Queries</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="avoid-interpolation"><a class="anchor" href="#avoid-interpolation"></a><a class="link" href="#avoid-interpolation">Avoid Interpolation</a></h3>
<div class="paragraph">
<p>Avoid string interpolation in queries, as it will make your code susceptible to SQL injection attacks.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - param will be interpolated unescaped</span>
<span class="no">Client</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s2">"orders_count = </span><span class="si">#{</span><span class="n">params</span><span class="p">[</span><span class="ss">:orders</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="c1"># good - param will be properly escaped</span>
<span class="no">Client</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s1">'orders_count = ?'</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="ss">:orders</span><span class="p">])</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="named-placeholder"><a class="anchor" href="#named-placeholder"></a><a class="link" href="#named-placeholder">Named Placeholder</a></h3>
<div class="paragraph">
<p>Consider using named placeholders instead of positional placeholders when you have more than 1 placeholder in your query.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># okish</span>
<span class="no">Client</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span>
  <span class="s1">'orders_count &gt;= ? AND country_code = ?'</span><span class="p">,</span>
  <span class="n">params</span><span class="p">[</span><span class="ss">:min_orders_count</span><span class="p">],</span> <span class="n">params</span><span class="p">[</span><span class="ss">:country_code</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># good</span>
<span class="no">Client</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span>
  <span class="s1">'orders_count &gt;= :min_orders_count AND country_code = :country_code'</span><span class="p">,</span>
  <span class="ss">min_orders_count: </span><span class="n">params</span><span class="p">[</span><span class="ss">:min_orders_count</span><span class="p">],</span> <span class="ss">country_code: </span><span class="n">params</span><span class="p">[</span><span class="ss">:country_code</span><span class="p">]</span>
<span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="find"><a class="anchor" href="#find"></a><a class="link" href="#find"><code>find</code></a></h3>
<div class="paragraph">
<p>Prefer <code>find</code> over <code>where.take!</code>, <code>find_by!</code>, and <code>find_by_id!</code> when you need to retrieve a single record by primary key id and raise <code>ActiveRecord::RecordNotFound</code> when the record is not found.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">id: </span><span class="nb">id</span><span class="p">).</span><span class="nf">take!</span>

<span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">find_by_id!</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>

<span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">find_by!</span><span class="p">(</span><span class="ss">id: </span><span class="nb">id</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="find_by"><a class="anchor" href="#find_by"></a><a class="link" href="#find_by"><code>find_by</code></a></h3>
<div class="paragraph">
<p>Prefer <code>find_by</code> over <code>where.take</code> and <code>find_by_attribute</code> when you need to retrieve a single record by one or more attributes and return <code>nil</code> when the record is not found.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">email: </span><span class="n">email</span><span class="p">).</span><span class="nf">take</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">first_name: </span><span class="s1">'Bruce'</span><span class="p">,</span> <span class="ss">last_name: </span><span class="s1">'Wayne'</span><span class="p">).</span><span class="nf">take</span>

<span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">find_by_email</span><span class="p">(</span><span class="n">email</span><span class="p">)</span>
<span class="no">User</span><span class="p">.</span><span class="nf">find_by_first_name_and_last_name</span><span class="p">(</span><span class="s1">'Bruce'</span><span class="p">,</span> <span class="s1">'Wayne'</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">email: </span><span class="n">email</span><span class="p">)</span>
<span class="no">User</span><span class="p">.</span><span class="nf">find_by</span><span class="p">(</span><span class="ss">first_name: </span><span class="s1">'Bruce'</span><span class="p">,</span> <span class="ss">last_name: </span><span class="s1">'Wayne'</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hash-conditions"><a class="anchor" href="#hash-conditions"></a><a class="link" href="#hash-conditions">Hash conditions <a id="where-not"></a></a></h3>
<div class="paragraph">
<p>Prefer passing conditions to <code>where</code> and <code>where.not</code> as a hash over using fragments of SQL.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s2">"name = ?"</span><span class="p">,</span> <span class="nb">name</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">name: </span><span class="nb">name</span><span class="p">)</span>

<span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s2">"id != ?"</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">.</span><span class="nf">not</span><span class="p">(</span><span class="ss">id: </span><span class="nb">id</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="finding-missing-relationship-records"><a class="anchor" href="#finding-missing-relationship-records"></a><a class="link" href="#finding-missing-relationship-records">Finding missing relationship records</a></h3>
<div class="paragraph">
<p>If you&#8217;re using Rails 6.1 or higher, use <a href="https://api.rubyonrails.org/classes/ActiveRecord/QueryMethods/WhereChain.html#method-i-missing">where.missing</a> to find missing relationship records.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Post</span><span class="p">.</span><span class="nf">left_joins</span><span class="p">(</span><span class="ss">:author</span><span class="p">).</span><span class="nf">where</span><span class="p">(</span><span class="ss">authors: </span><span class="p">{</span> <span class="ss">id: </span><span class="kp">nil</span> <span class="p">})</span>

<span class="c1"># good</span>
<span class="no">Post</span><span class="p">.</span><span class="nf">where</span><span class="p">.</span><span class="nf">missing</span><span class="p">(</span><span class="ss">:author</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="order-by-id"><a class="anchor" href="#order-by-id"></a><a class="link" href="#order-by-id">Order by <code>id</code></a></h3>
<div class="paragraph">
<p>Don&#8217;t use the <code>id</code> column for ordering.
The sequence of ids is not guaranteed to be in any particular order, despite often (incidentally) being chronological.
Use a timestamp column to order chronologically.
As a bonus the intent is clearer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">scope</span> <span class="ss">:chronological</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="n">order</span><span class="p">(</span><span class="ss">id: :asc</span><span class="p">)</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="n">scope</span> <span class="ss">:chronological</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="n">order</span><span class="p">(</span><span class="ss">created_at: :asc</span><span class="p">)</span> <span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pluck"><a class="anchor" href="#pluck"></a><a class="link" href="#pluck"><code>pluck</code></a></h3>
<div class="paragraph">
<p>Use <a href="https://api.rubyonrails.org/classes/ActiveRecord/Calculations.html#method-i-pluck">pluck</a> to select a single value from multiple records.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">map</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:name</span><span class="p">)</span>

<span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">map</span> <span class="p">{</span> <span class="o">|</span><span class="n">user</span><span class="o">|</span> <span class="n">user</span><span class="p">[</span><span class="ss">:name</span><span class="p">]</span> <span class="p">}</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">pluck</span><span class="p">(</span><span class="ss">:name</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="pick"><a class="anchor" href="#pick"></a><a class="link" href="#pick"><code>pick</code></a></h3>
<div class="paragraph">
<p>Use <a href="https://api.rubyonrails.org/classes/ActiveRecord/Calculations.html#method-i-pick">pick</a> to select a single value from a single record.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">pluck</span><span class="p">(</span><span class="ss">:name</span><span class="p">).</span><span class="nf">first</span>

<span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">first</span><span class="p">.</span><span class="nf">name</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">pick</span><span class="p">(</span><span class="ss">:name</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="ids"><a class="anchor" href="#ids"></a><a class="link" href="#ids"><code>ids</code></a></h3>
<div class="paragraph">
<p>Prefer <code>ids</code> over <code>pluck(:id)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">pluck</span><span class="p">(</span><span class="ss">:id</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">ids</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="squished-heredocs"><a class="anchor" href="#squished-heredocs"></a><a class="link" href="#squished-heredocs">Squished Heredocs</a></h3>
<div class="paragraph">
<p>When specifying an explicit query in a method such as <code>find_by_sql</code>, use heredocs with <code>squish</code>.
This allows you to legibly format the SQL with line breaks and indentations, while supporting syntax highlighting in many tools (including GitHub, Atom, and RubyMine).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="no">User</span><span class="p">.</span><span class="nf">find_by_sql</span><span class="p">(</span><span class="o">&lt;&lt;-</span><span class="no">SQL</span><span class="p">.</span><span class="nf">squish</span><span class="p">)</span><span class="sh">
  SELECT
    users.id, accounts.plan
  FROM
    users
  INNER JOIN
    accounts
  ON
    accounts.user_id = users.id
  # further complexities...
</span><span class="no">SQL</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://api.rubyonrails.org/classes/String.html#method-i-squish"><code>String#squish</code></a> removes the indentation and newline characters so that your server log shows a fluid string of SQL rather than something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>SELECT\n    users.id, accounts.plan\n  FROM\n    users\n  INNER JOIN\n    accounts\n  ON\n    accounts.user_id = users.id</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="size-over-count-or-length"><a class="anchor" href="#size-over-count-or-length"></a><a class="link" href="#size-over-count-or-length"><code>size</code> over <code>count</code> or <code>length</code></a></h3>
<div class="paragraph">
<p>When querying Active Record collections, prefer <code>size</code> (selects between count/length behavior based on whether collection is already loaded) or <code>length</code> (always loads the whole collection and counts the array elements) over <code>count</code> (always does a database query for the count).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">count</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">size</span>

<span class="c1"># good - if you really need to load all users into memory</span>
<span class="no">User</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">length</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="where-ranges"><a class="anchor" href="#where-ranges"></a><a class="link" href="#where-ranges">Where with Ranges</a></h3>
<div class="paragraph">
<p>Use ranges instead of defining comparative conditions using a template for scalar values.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s2">"created_at &gt;= ?"</span><span class="p">,</span> <span class="mi">30</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">).</span><span class="nf">where</span><span class="p">(</span><span class="s2">"created_at &lt;= ?"</span><span class="p">,</span> <span class="mi">7</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">)</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s2">"created_at &gt;= ? AND created_at &lt;= ?"</span><span class="p">,</span> <span class="mi">30</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">,</span> <span class="mi">7</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">)</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s2">"created_at &gt;= :start AND created_at &lt;= :end"</span><span class="p">,</span> <span class="ss">start: </span><span class="mi">30</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">,</span> <span class="ss">end: </span><span class="mi">7</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">created_at: </span><span class="mi">30</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="o">..</span><span class="mi">7</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">)</span>

<span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s2">"created_at &gt;= ?"</span><span class="p">,</span> <span class="mi">7</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">created_at: </span><span class="mi">7</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="o">..</span><span class="p">)</span>

<span class="c1"># note - ranges are inclusive or exclusive of their ending, not beginning</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">created_at: </span><span class="mi">7</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="o">..</span><span class="p">)</span>  <span class="c1"># produces &gt;=</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">created_at: </span><span class="mi">7</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="o">...</span><span class="p">)</span> <span class="c1"># also produces &gt;=</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">created_at: </span><span class="o">..</span><span class="mi">7</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">)</span>  <span class="c1"># inclusive: produces &lt;=</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">created_at: </span><span class="o">...</span><span class="mi">7</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">)</span> <span class="c1"># exclusive: produces &lt;</span>

<span class="c1"># okish - there is no range syntax that would denote exclusion at the beginning of the range</span>
<span class="no">Customer</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="s2">"purchases_count &gt; :min AND purchases_count &lt;= :max"</span><span class="p">,</span> <span class="ss">min: </span><span class="mi">0</span><span class="p">,</span> <span class="ss">max: </span><span class="mi">5</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Rails 6.0 or later is required for endless range Ruby 2.6 syntax, and Rails 6.0.3 for beginless range Ruby 2.7 syntax.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="where-not-with-multiple-attributes"><a class="anchor" href="#where-not-with-multiple-attributes"></a><a class="link" href="#where-not-with-multiple-attributes"><code>where.not</code> with multiple attributes</a></h3>
<div class="paragraph">
<p>Avoid passing multiple attributes to <code>where.not</code>. Rails logic in this case has changed in Rails 6.1 and
will now yield results matching either of those conditions,
e.g. <code>where.not(status: 'active', plan: 'basic')</code> would return records with active status when the plan is business.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">.</span><span class="nf">not</span><span class="p">(</span><span class="ss">status: </span><span class="s1">'active'</span><span class="p">,</span> <span class="ss">plan: </span><span class="s1">'basic'</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">where</span><span class="p">.</span><span class="nf">not</span><span class="p">(</span><span class="s1">'status = ? AND plan = ?'</span><span class="p">,</span> <span class="s1">'active'</span><span class="p">,</span> <span class="s1">'basic'</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="redundant-all"><a class="anchor" href="#redundant-all"></a><a class="link" href="#redundant-all">Redundant <code>all</code></a></h3>
<div class="paragraph">
<p>Using <code>all</code> as a receiver is redundant. The result won&#8217;t change without <code>all</code>, so it should be removed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">User</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
<span class="no">User</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:created_at</span><span class="p">)</span>
<span class="n">users</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">id: </span><span class="n">ids</span><span class="p">)</span>
<span class="n">user</span><span class="p">.</span><span class="nf">articles</span><span class="p">.</span><span class="nf">all</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:created_at</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="no">User</span><span class="p">.</span><span class="nf">find</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
<span class="no">User</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:created_at</span><span class="p">)</span>
<span class="n">users</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">id: </span><span class="n">ids</span><span class="p">)</span>
<span class="n">user</span><span class="p">.</span><span class="nf">articles</span><span class="p">.</span><span class="nf">order</span><span class="p">(</span><span class="ss">:created_at</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When the receiver for <code>all</code> is an association, there are methods whose behavior changes by omitting <code>all</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The following methods behave differently without <code>all</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>delete</code> - <a href="https://api.rubyonrails.org/classes/ActiveRecord/Persistence/ClassMethods.html#method-i-delete">with all</a> / <a href="https://api.rubyonrails.org/classes/ActiveRecord/Associations/CollectionProxy.html#method-i-delete">without all</a></p>
</li>
<li>
<p><code>delete_all</code> - <a href="https://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-delete_all">with all</a> / <a href="https://api.rubyonrails.org/classes/ActiveRecord/Associations/CollectionProxy.html#method-i-delete_all">without all</a></p>
</li>
<li>
<p><code>destroy</code> - <a href="https://api.rubyonrails.org/classes/ActiveRecord/Persistence/ClassMethods.html#method-i-destroy">with all</a> / <a href="https://api.rubyonrails.org/classes/ActiveRecord/Associations/CollectionProxy.html#method-i-destroy">without all</a></p>
</li>
<li>
<p><code>destroy_all</code> - <a href="https://api.rubyonrails.org/classes/ActiveRecord/Relation.html#method-i-destroy_all">with all</a> / <a href="https://api.rubyonrails.org/classes/ActiveRecord/Associations/CollectionProxy.html#method-i-destroy_all">without all</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>So, when considering removing <code>all</code> from the receiver of these methods, it is recommended to refer to the documentation to understand how the behavior changes.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="migrations"><a class="anchor" href="#migrations"></a><a class="link" href="#migrations">Migrations</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="schema-version"><a class="anchor" href="#schema-version"></a><a class="link" href="#schema-version">Schema Version</a></h3>
<div class="paragraph">
<p>Keep the <code>schema.rb</code> (or <code>structure.sql</code>) under version control.</p>
</div>
</div>
<div class="sect2">
<h3 id="db-schema-load"><a class="anchor" href="#db-schema-load"></a><a class="link" href="#db-schema-load">DB Schema Load</a></h3>
<div class="paragraph">
<p>Use <code>rake db:schema:load</code> instead of <code>rake db:migrate</code> to initialize an empty database.</p>
</div>
</div>
<div class="sect2">
<h3 id="default-migration-values"><a class="anchor" href="#default-migration-values"></a><a class="link" href="#default-migration-values">Default Migration Values</a></h3>
<div class="paragraph">
<p>Enforce default values in the migrations themselves instead of in the application layer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - application enforced default value</span>
<span class="k">class</span> <span class="nc">Product</span> <span class="o">&lt;</span> <span class="no">ApplicationRecord</span>
  <span class="k">def</span> <span class="nf">amount</span>
    <span class="nb">self</span><span class="p">[</span><span class="ss">:amount</span><span class="p">]</span> <span class="o">||</span> <span class="mi">0</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good - database enforced</span>
<span class="k">class</span> <span class="nc">AddDefaultAmountToProducts</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">change</span>
    <span class="n">change_column_default</span> <span class="ss">:products</span><span class="p">,</span> <span class="ss">:amount</span><span class="p">,</span> <span class="mi">0</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>While enforcing table defaults only in Rails is suggested by many Rails developers, it&#8217;s an extremely brittle approach that leaves your data vulnerable to many application bugs.
And you&#8217;ll have to consider the fact that most non-trivial apps share a database with other applications, so imposing data integrity from the Rails app is impossible.</p>
</div>
</div>
<div class="sect2">
<h3 id="three-state-boolean"><a class="anchor" href="#three-state-boolean"></a><a class="link" href="#three-state-boolean">3-state Boolean</a></h3>
<div class="paragraph">
<p>With SQL databases, if a boolean column is not given a default value, it will have three possible values: <code>true</code>, <code>false</code> and <code>NULL</code>.
Boolean operators <a href="https://en.wikipedia.org/wiki/Three-valued_logic">work in unexpected ways</a> with <code>NULL</code>.</p>
</div>
<div class="paragraph">
<p>For example in SQL queries, <code>true AND NULL</code> is <code>NULL</code> (not false), <code>true AND NULL OR false</code> is <code>NULL</code> (not false). This can make SQL queries return unexpected results.</p>
</div>
<div class="paragraph">
<p>To avoid such situations, boolean columns should always have a default value and a <code>NOT NULL</code> constraint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - boolean without a default value</span>
<span class="n">add_column</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:active</span><span class="p">,</span> <span class="ss">:boolean</span>

<span class="c1"># good - boolean with a default value (`false` or `true`) and with restricted `NULL`</span>
<span class="n">add_column</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:active</span><span class="p">,</span> <span class="ss">:boolean</span><span class="p">,</span> <span class="ss">default: </span><span class="kp">true</span><span class="p">,</span> <span class="ss">null: </span><span class="kp">false</span>
<span class="n">add_column</span> <span class="ss">:users</span><span class="p">,</span> <span class="ss">:admin</span><span class="p">,</span> <span class="ss">:boolean</span><span class="p">,</span> <span class="ss">default: </span><span class="kp">false</span><span class="p">,</span> <span class="ss">null: </span><span class="kp">false</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="foreign-key-constraints"><a class="anchor" href="#foreign-key-constraints"></a><a class="link" href="#foreign-key-constraints">Foreign Key Constraints</a></h3>
<div class="paragraph">
<p>Enforce foreign-key constraints. As of Rails 4.2, Active Record supports foreign key constraints natively.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - does not add foreign keys</span>
<span class="n">create_table</span> <span class="ss">:comment</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
  <span class="n">t</span><span class="p">.</span><span class="nf">references</span> <span class="ss">:article</span>
  <span class="n">t</span><span class="p">.</span><span class="nf">belongs_to</span> <span class="ss">:user</span>
  <span class="n">t</span><span class="p">.</span><span class="nf">integer</span> <span class="ss">:category_id</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="n">create_table</span> <span class="ss">:comment</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
  <span class="n">t</span><span class="p">.</span><span class="nf">references</span> <span class="ss">:article</span><span class="p">,</span> <span class="ss">foreign_key: </span><span class="kp">true</span>
  <span class="n">t</span><span class="p">.</span><span class="nf">belongs_to</span> <span class="ss">:user</span><span class="p">,</span> <span class="ss">foreign_key: </span><span class="kp">true</span>
  <span class="n">t</span><span class="p">.</span><span class="nf">references</span> <span class="ss">:category</span><span class="p">,</span> <span class="ss">foreign_key: </span><span class="p">{</span> <span class="ss">to_table: :comment_categories</span> <span class="p">}</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="change-vs-up-down"><a class="anchor" href="#change-vs-up-down"></a><a class="link" href="#change-vs-up-down">Change vs Up/Down</a></h3>
<div class="paragraph">
<p>When writing constructive migrations (adding tables or columns), use the <code>change</code> method instead of <code>up</code> and <code>down</code> methods.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># the old way</span>
<span class="k">class</span> <span class="nc">AddNameToPeople</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">up</span>
    <span class="n">add_column</span> <span class="ss">:people</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:string</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">down</span>
    <span class="n">remove_column</span> <span class="ss">:people</span><span class="p">,</span> <span class="ss">:name</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># the new preferred way</span>
<span class="k">class</span> <span class="nc">AddNameToPeople</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">change</span>
    <span class="n">add_column</span> <span class="ss">:people</span><span class="p">,</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">:string</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="define-model-class-migrations"><a class="anchor" href="#define-model-class-migrations"></a><a class="link" href="#define-model-class-migrations">Define Model Class Migrations</a></h3>
<div class="paragraph">
<p>If you have to use models in migrations, make sure you define them so that you don&#8217;t end up with broken migrations in the future.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># db/migrate/&lt;migration_file_name&gt;.rb</span>
<span class="c1"># frozen_string_literal: true</span>

<span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">ModifyDefaultStatusForProducts</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">change</span>
    <span class="n">old_status</span> <span class="o">=</span> <span class="s1">'pending_manual_approval'</span>
    <span class="n">new_status</span> <span class="o">=</span> <span class="s1">'pending_approval'</span>

    <span class="n">reversible</span> <span class="k">do</span> <span class="o">|</span><span class="n">dir</span><span class="o">|</span>
      <span class="n">dir</span><span class="p">.</span><span class="nf">up</span> <span class="k">do</span>
        <span class="no">Product</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">status: </span><span class="n">old_status</span><span class="p">).</span><span class="nf">update_all</span><span class="p">(</span><span class="ss">status: </span><span class="n">new_status</span><span class="p">)</span>
        <span class="n">change_column</span> <span class="ss">:products</span><span class="p">,</span> <span class="ss">:status</span><span class="p">,</span> <span class="ss">:string</span><span class="p">,</span> <span class="ss">default: </span><span class="n">new_status</span>
      <span class="k">end</span>

      <span class="n">dir</span><span class="p">.</span><span class="nf">down</span> <span class="k">do</span>
        <span class="no">Product</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">status: </span><span class="n">new_status</span><span class="p">).</span><span class="nf">update_all</span><span class="p">(</span><span class="ss">status: </span><span class="n">old_status</span><span class="p">)</span>
        <span class="n">change_column</span> <span class="ss">:products</span><span class="p">,</span> <span class="ss">:status</span><span class="p">,</span> <span class="ss">:string</span><span class="p">,</span> <span class="ss">default: </span><span class="n">old_status</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="c1"># Define `table_name` in a custom named class to make sure that you run on the</span>
<span class="c1"># same table you had during the creation of the migration.</span>
<span class="c1"># In future if you override the `Product` class and change the `table_name`,</span>
<span class="c1"># it won't break the migration or cause serious data corruption.</span>
<span class="k">class</span> <span class="nc">MigrationProduct</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="nb">self</span><span class="p">.</span><span class="nf">table_name</span> <span class="o">=</span> <span class="ss">:products</span>
<span class="k">end</span>

<span class="k">class</span> <span class="nc">ModifyDefaultStatusForProducts</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">change</span>
    <span class="n">old_status</span> <span class="o">=</span> <span class="s1">'pending_manual_approval'</span>
    <span class="n">new_status</span> <span class="o">=</span> <span class="s1">'pending_approval'</span>

    <span class="n">reversible</span> <span class="k">do</span> <span class="o">|</span><span class="n">dir</span><span class="o">|</span>
      <span class="n">dir</span><span class="p">.</span><span class="nf">up</span> <span class="k">do</span>
        <span class="no">MigrationProduct</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">status: </span><span class="n">old_status</span><span class="p">).</span><span class="nf">update_all</span><span class="p">(</span><span class="ss">status: </span><span class="n">new_status</span><span class="p">)</span>
        <span class="n">change_column</span> <span class="ss">:products</span><span class="p">,</span> <span class="ss">:status</span><span class="p">,</span> <span class="ss">:string</span><span class="p">,</span> <span class="ss">default: </span><span class="n">new_status</span>
      <span class="k">end</span>

      <span class="n">dir</span><span class="p">.</span><span class="nf">down</span> <span class="k">do</span>
        <span class="no">MigrationProduct</span><span class="p">.</span><span class="nf">where</span><span class="p">(</span><span class="ss">status: </span><span class="n">new_status</span><span class="p">).</span><span class="nf">update_all</span><span class="p">(</span><span class="ss">status: </span><span class="n">old_status</span><span class="p">)</span>
        <span class="n">change_column</span> <span class="ss">:products</span><span class="p">,</span> <span class="ss">:status</span><span class="p">,</span> <span class="ss">:string</span><span class="p">,</span> <span class="ss">default: </span><span class="n">old_status</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="meaningful-foreign-key-naming"><a class="anchor" href="#meaningful-foreign-key-naming"></a><a class="link" href="#meaningful-foreign-key-naming">Meaningful Foreign Key Naming</a></h3>
<div class="paragraph">
<p>Name your foreign keys explicitly instead of relying on Rails auto-generated FK names. (<a href="https://guides.rubyonrails.org/active_record_migrations.html#foreign-keys" class="bare">https://guides.rubyonrails.org/active_record_migrations.html#foreign-keys</a>)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">AddFkArticlesToAuthors</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">change</span>
    <span class="n">add_foreign_key</span> <span class="ss">:articles</span><span class="p">,</span> <span class="ss">:authors</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">AddFkArticlesToAuthors</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">change</span>
    <span class="n">add_foreign_key</span> <span class="ss">:articles</span><span class="p">,</span> <span class="ss">:authors</span><span class="p">,</span> <span class="ss">name: :articles_author_id_fk</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="reversible-migration"><a class="anchor" href="#reversible-migration"></a><a class="link" href="#reversible-migration">Reversible Migration</a></h3>
<div class="paragraph">
<p>Don&#8217;t use non-reversible migration commands in the <code>change</code> method.
Reversible migration commands are listed below.
<a href="https://api.rubyonrails.org/classes/ActiveRecord/Migration/CommandRecorder.html">ActiveRecord::Migration::CommandRecorder</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">DropUsers</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">change</span>
    <span class="n">drop_table</span> <span class="ss">:users</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">DropUsers</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">up</span>
    <span class="n">drop_table</span> <span class="ss">:users</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">down</span>
    <span class="n">create_table</span> <span class="ss">:users</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
      <span class="n">t</span><span class="p">.</span><span class="nf">string</span> <span class="ss">:name</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="c1"># In this case, block will be used by create_table in rollback</span>
<span class="c1"># https://api.rubyonrails.org/classes/ActiveRecord/ConnectionAdapters.html#method-i-drop_table</span>
<span class="k">class</span> <span class="nc">DropUsers</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Migration</span>
  <span class="k">def</span> <span class="nf">change</span>
    <span class="n">drop_table</span> <span class="ss">:users</span> <span class="k">do</span> <span class="o">|</span><span class="n">t</span><span class="o">|</span>
      <span class="n">t</span><span class="p">.</span><span class="nf">string</span> <span class="ss">:name</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="views"><a class="anchor" href="#views"></a><a class="link" href="#views">Views</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="no-direct-model-view"><a class="anchor" href="#no-direct-model-view"></a><a class="link" href="#no-direct-model-view">No Direct Model View</a></h3>
<div class="paragraph">
<p>Never call the model layer directly from a view.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-complex-view-formatting"><a class="anchor" href="#no-complex-view-formatting"></a><a class="link" href="#no-complex-view-formatting">No Complex View Formatting</a></h3>
<div class="paragraph">
<p>Avoid complex formatting in the views.
A view helper is useful for simple cases, but if it&#8217;s more complex then consider using a decorator or presenter.</p>
</div>
</div>
<div class="sect2">
<h3 id="partials"><a class="anchor" href="#partials"></a><a class="link" href="#partials">Partials</a></h3>
<div class="paragraph">
<p>Mitigate code duplication by using partial templates and layouts.</p>
</div>
</div>
<div class="sect2">
<h3 id="no-instance-variables-in-partials"><a class="anchor" href="#no-instance-variables-in-partials"></a><a class="link" href="#no-instance-variables-in-partials">No Instance Variables in Partials</a></h3>
<div class="paragraph">
<p>Avoid using instance variables in partials, pass a local variable to <code>render</code> instead.
The partial may be used in a different controller or action, where the variable can have a different name or even be absent.
In these cases, an undefined instance variable will not raise an exception whereas a local variable will.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="erb"><span class="c">&lt;!-- bad --&gt;</span>
<span class="c">&lt;!-- app/views/courses/show.html.erb --&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'course_description'</span> <span class="cp">%&gt;</span>
<span class="c">&lt;!-- app/views/courses/_course_description.html.erb --&gt;</span>
<span class="cp">&lt;%=</span> <span class="vi">@course</span><span class="p">.</span><span class="nf">description</span> <span class="cp">%&gt;</span>

<span class="c">&lt;!-- good --&gt;</span>
<span class="c">&lt;!-- app/views/courses/show.html.erb --&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'course_description'</span><span class="p">,</span> <span class="ss">course: </span><span class="vi">@course</span> <span class="cp">%&gt;</span>
<span class="c">&lt;!-- app/views/courses/_course_description.html.erb --&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">course</span><span class="p">.</span><span class="nf">description</span> <span class="cp">%&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="internationalization"><a class="anchor" href="#internationalization"></a><a class="link" href="#internationalization">Internationalization</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="locale-texts"><a class="anchor" href="#locale-texts"></a><a class="link" href="#locale-texts">Locale Texts</a></h3>
<div class="paragraph">
<p>No strings or other locale specific settings should be used in the views, models and controllers.
These texts should be moved to the locale files in the <code>config/locales</code> directory.</p>
</div>
</div>
<div class="sect2">
<h3 id="translated-labels"><a class="anchor" href="#translated-labels"></a><a class="link" href="#translated-labels">Translated Labels</a></h3>
<div class="paragraph">
<p>When the labels of an Active Record model need to be translated, use the <code>activerecord</code> scope:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>en:
  activerecord:
    models:
      user: Member
    attributes:
      user:
        name: 'Full name'</pre>
</div>
</div>
<div class="paragraph">
<p>Then <code>User.model_name.human</code> will return "Member" and <code>User.human_attribute_name("name")</code> will return "Full name".
These translations of the attributes will be used as labels in the views.</p>
</div>
</div>
<div class="sect2">
<h3 id="organize-locale-files"><a class="anchor" href="#organize-locale-files"></a><a class="link" href="#organize-locale-files">Organize Locale Files</a></h3>
<div class="paragraph">
<p>Separate the texts used in the views from translations of Active Record attributes.
Place the locale files for the models in a folder <code>locales/models</code> and the texts used in the views in folder <code>locales/views</code>.</p>
</div>
<div class="paragraph">
<p>When organization of the locale files is done with additional directories, these directories must be described in the <code>application.rb</code> file in order to be loaded.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># config/application.rb</span>
<span class="n">config</span><span class="p">.</span><span class="nf">i18n</span><span class="p">.</span><span class="nf">load_path</span> <span class="o">+=</span> <span class="no">Dir</span><span class="p">[</span><span class="no">Rails</span><span class="p">.</span><span class="nf">root</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s1">'config'</span><span class="p">,</span> <span class="s1">'locales'</span><span class="p">,</span> <span class="s1">'**'</span><span class="p">,</span> <span class="s1">'*.{rb,yml}'</span><span class="p">)]</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="shared-localization"><a class="anchor" href="#shared-localization"></a><a class="link" href="#shared-localization">Shared Localization</a></h3>
<div class="paragraph">
<p>Place the shared localization options, such as date or currency formats, in files under the root of the <code>locales</code> directory.</p>
</div>
</div>
<div class="sect2">
<h3 id="short-i18n"><a class="anchor" href="#short-i18n"></a><a class="link" href="#short-i18n">Short I18n</a></h3>
<div class="paragraph">
<p>Use the short form of the I18n methods: <code>I18n.t</code> instead of <code>I18n.translate</code> and <code>I18n.l</code> instead of <code>I18n.localize</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="lazy-lookup"><a class="anchor" href="#lazy-lookup"></a><a class="link" href="#lazy-lookup">Lazy Lookup</a></h3>
<div class="paragraph">
<p>Use "lazy" lookup for locale entries from views and controllers. Let&#8217;s say we have the following structure:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>en:
  users:
    show:
      title: 'User details page'</pre>
</div>
</div>
<div class="paragraph">
<p>The value for <code>users.show.title</code> can be looked up in the template <code>app/views/users/show.html.haml</code> like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="o">=</span> <span class="n">t</span> <span class="s1">'users.show.title'</span>

<span class="c1"># good</span>
<span class="o">=</span> <span class="n">t</span> <span class="s1">'.title'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="dot-separated-keys"><a class="anchor" href="#dot-separated-keys"></a><a class="link" href="#dot-separated-keys">Dot-separated Keys</a></h3>
<div class="paragraph">
<p>Use dot-separated locale keys instead of specifying the <code>:scope</code> option with an array or a single symbol.
Dot-separated notation is easier to read and trace the hierarchy.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">I18n</span><span class="p">.</span><span class="nf">t</span> <span class="ss">:record_invalid</span><span class="p">,</span> <span class="ss">scope: </span><span class="p">[</span><span class="ss">:activerecord</span><span class="p">,</span> <span class="ss">:errors</span><span class="p">,</span> <span class="ss">:messages</span><span class="p">]</span>

<span class="c1"># good</span>
<span class="no">I18n</span><span class="p">.</span><span class="nf">t</span> <span class="ss">:record_invalid</span><span class="p">,</span> <span class="ss">scope: </span><span class="s1">'activerecord.errors.messages'</span>
<span class="no">I18n</span><span class="p">.</span><span class="nf">t</span> <span class="s1">'activerecord.errors.messages.record_invalid'</span>

<span class="c1"># bad</span>
<span class="no">I18n</span><span class="p">.</span><span class="nf">t</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">scope: :invitation</span>

<span class="c1"># good</span>
<span class="no">I18n</span><span class="p">.</span><span class="nf">t</span> <span class="s1">'title.invitation'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="i18n-guides"><a class="anchor" href="#i18n-guides"></a><a class="link" href="#i18n-guides">I18n Guides</a></h3>
<div class="paragraph">
<p>More detailed information about the Rails I18n can be found in the <a href="https://guides.rubyonrails.org/i18n.html">Rails Guides</a></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="assets"><a class="anchor" href="#assets"></a><a class="link" href="#assets">Assets</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Use the <a href="https://guides.rubyonrails.org/asset_pipeline.html">asset pipeline</a> to leverage organization within your application.</p>
</div>
<div class="sect2">
<h3 id="reserve-app-assets"><a class="anchor" href="#reserve-app-assets"></a><a class="link" href="#reserve-app-assets">Reserve <code>app/assets</code></a></h3>
<div class="paragraph">
<p>Reserve <code>app/assets</code> for custom stylesheets, javascripts, or images.</p>
</div>
</div>
<div class="sect2">
<h3 id="lib-assets"><a class="anchor" href="#lib-assets"></a><a class="link" href="#lib-assets"><code>lib/assets</code></a></h3>
<div class="paragraph">
<p>Use <code>lib/assets</code> for your own libraries that don&#8217;t really fit into the scope of the application.</p>
</div>
</div>
<div class="sect2">
<h3 id="vendor-assets"><a class="anchor" href="#vendor-assets"></a><a class="link" href="#vendor-assets"><code>vendor/assets</code></a></h3>
<div class="paragraph">
<p>Third party code such as <a href="https://jquery.com/">jQuery</a> or <a href="https://twitter.github.com/bootstrap/">bootstrap</a> should be placed in <code>vendor/assets</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="gem-assets"><a class="anchor" href="#gem-assets"></a><a class="link" href="#gem-assets"><code>gem/assets</code></a></h3>
<div class="paragraph">
<p>When possible, use gemified versions of assets (e.g. <a href="https://github.com/rails/jquery-rails">jquery-rails</a>, <a href="https://github.com/joliss/jquery-ui-rails">jquery-ui-rails</a>, <a href="https://github.com/thomas-mcdonald/bootstrap-sass">bootstrap-sass</a>, <a href="https://github.com/zurb/foundation">zurb-foundation</a>).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mailers"><a class="anchor" href="#mailers"></a><a class="link" href="#mailers">Mailers</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="mailer-name"><a class="anchor" href="#mailer-name"></a><a class="link" href="#mailer-name">Mailer Name</a></h3>
<div class="paragraph">
<p>Name the mailers <code>SomethingMailer</code>.
Without the Mailer suffix it isn&#8217;t immediately apparent what&#8217;s a mailer and which views are related to the mailer.</p>
</div>
</div>
<div class="sect2">
<h3 id="html-plain-email"><a class="anchor" href="#html-plain-email"></a><a class="link" href="#html-plain-email">HTML Plain Email</a></h3>
<div class="paragraph">
<p>Provide both HTML and plain-text view templates.</p>
</div>
</div>
<div class="sect2">
<h3 id="enable-delivery-errors"><a class="anchor" href="#enable-delivery-errors"></a><a class="link" href="#enable-delivery-errors">Enable Delivery Errors</a></h3>
<div class="paragraph">
<p>Enable errors raised on failed mail delivery in your development environment.
The errors are disabled by default.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># config/environments/development.rb</span>

<span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">raise_delivery_errors</span> <span class="o">=</span> <span class="kp">true</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="local-smtp"><a class="anchor" href="#local-smtp"></a><a class="link" href="#local-smtp">Local SMTP</a></h3>
<div class="paragraph">
<p>Use a local SMTP server like <a href="https://github.com/sj26/mailcatcher">Mailcatcher</a> in development environment.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># config/environments/development.rb</span>

<span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">smtp_settings</span> <span class="o">=</span> <span class="p">{</span>
  <span class="ss">address: </span><span class="s1">'localhost'</span><span class="p">,</span>
  <span class="ss">port: </span><span class="mi">1025</span><span class="p">,</span>
  <span class="c1"># more settings</span>
<span class="p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="default-hostname"><a class="anchor" href="#default-hostname"></a><a class="link" href="#default-hostname">Default Hostname</a></h3>
<div class="paragraph">
<p>Provide default settings for the host name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># config/environments/development.rb</span>
<span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">default_url_options</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">host: </span><span class="s2">"</span><span class="si">#{</span><span class="n">local_ip</span><span class="si">}</span><span class="s2">:3000"</span> <span class="p">}</span>

<span class="c1"># config/environments/production.rb</span>
<span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">default_url_options</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">host: </span><span class="s1">'your_site.com'</span> <span class="p">}</span>

<span class="c1"># in your mailer class</span>
<span class="n">default_url_options</span><span class="p">[</span><span class="ss">:host</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'your_site.com'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="email-addresses"><a class="anchor" href="#email-addresses"></a><a class="link" href="#email-addresses">Email Addresses</a></h3>
<div class="paragraph">
<p>Format the from and to addresses properly.
Use the following format:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># in your mailer class</span>
<span class="n">default</span> <span class="ss">from: </span><span class="s1">'Your Name &lt;info@your_site.com&gt;'</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you&#8217;re using Rails 6.1 or higher, you can use the <code>email_address_with_name</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># in your mailer class</span>
<span class="n">default</span> <span class="ss">from: </span><span class="n">email_address_with_name</span><span class="p">(</span><span class="s1">'info@your_site.com'</span><span class="p">,</span> <span class="s1">'Your Name'</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="delivery-method-test"><a class="anchor" href="#delivery-method-test"></a><a class="link" href="#delivery-method-test">Delivery Method Test</a></h3>
<div class="paragraph">
<p>Make sure that the e-mail delivery method for your test environment is set to <code>test</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># config/environments/test.rb</span>

<span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">delivery_method</span> <span class="o">=</span> <span class="ss">:test</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="delivery-method-smtp"><a class="anchor" href="#delivery-method-smtp"></a><a class="link" href="#delivery-method-smtp">Delivery Method SMTP</a></h3>
<div class="paragraph">
<p>The delivery method for development and production should be <code>smtp</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># config/environments/development.rb, config/environments/production.rb</span>

<span class="n">config</span><span class="p">.</span><span class="nf">action_mailer</span><span class="p">.</span><span class="nf">delivery_method</span> <span class="o">=</span> <span class="ss">:smtp</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="inline-email-styles"><a class="anchor" href="#inline-email-styles"></a><a class="link" href="#inline-email-styles">Inline Email Styles</a></h3>
<div class="paragraph">
<p>When sending html emails all styles should be inline, as some mail clients have problems with external styles.
This however makes them harder to maintain and leads to code duplication.
There are two similar gems that transform the styles and put them in the corresponding html tags: <a href="https://github.com/fphilipe/premailer-rails">premailer-rails</a> and <a href="https://github.com/Mange/roadie">roadie</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="background-email"><a class="anchor" href="#background-email"></a><a class="link" href="#background-email">Background Email</a></h3>
<div class="paragraph">
<p>Sending emails while generating page response should be avoided.
It causes delays in loading of the page and request can timeout if multiple email are sent.
To overcome this emails can be sent in background process with the help of <a href="https://github.com/mperham/sidekiq">sidekiq</a> gem.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="active-support-core-extensions"><a class="anchor" href="#active-support-core-extensions"></a><a class="link" href="#active-support-core-extensions">Active Support Core Extensions</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="try-bang"><a class="anchor" href="#try-bang"></a><a class="link" href="#try-bang"><code>try!</code></a></h3>
<div class="paragraph">
<p>Prefer Ruby 2.3&#8217;s safe navigation operator <code>&amp;.</code> over <code>ActiveSupport#try!</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">obj</span><span class="p">.</span><span class="nf">try!</span> <span class="ss">:fly</span>

<span class="c1"># good</span>
<span class="n">obj</span><span class="o">&amp;</span><span class="p">.</span><span class="nf">fly</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="active_support_aliases"><a class="anchor" href="#active_support_aliases"></a><a class="link" href="#active_support_aliases">Active Support Aliases</a></h3>
<div class="paragraph">
<p>Prefer Ruby&#8217;s Standard Library methods over <code>ActiveSupport</code> aliases.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="s1">'the day'</span><span class="p">.</span><span class="nf">starts_with?</span> <span class="s1">'th'</span>
<span class="s1">'the day'</span><span class="p">.</span><span class="nf">ends_with?</span> <span class="s1">'ay'</span>

<span class="c1"># good</span>
<span class="s1">'the day'</span><span class="p">.</span><span class="nf">start_with?</span> <span class="s1">'th'</span>
<span class="s1">'the day'</span><span class="p">.</span><span class="nf">end_with?</span> <span class="s1">'ay'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="active_support_extensions"><a class="anchor" href="#active_support_extensions"></a><a class="link" href="#active_support_extensions">Active Support Extensions</a></h3>
<div class="paragraph">
<p>Prefer Ruby&#8217;s Standard Library over uncommon Active Support extensions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">50</span><span class="p">).</span><span class="nf">to_a</span><span class="p">.</span><span class="nf">forty_two</span>
<span class="mi">1</span><span class="p">.</span><span class="nf">in?</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="s1">'day'</span><span class="p">.</span><span class="nf">in?</span> <span class="s1">'the day'</span>

<span class="c1"># good</span>
<span class="p">(</span><span class="mi">1</span><span class="o">..</span><span class="mi">50</span><span class="p">).</span><span class="nf">to_a</span><span class="p">[</span><span class="mi">41</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">].</span><span class="nf">include?</span> <span class="mi">1</span>
<span class="s1">'the day'</span><span class="p">.</span><span class="nf">include?</span> <span class="s1">'day'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="inquiry"><a class="anchor" href="#inquiry"></a><a class="link" href="#inquiry"><code>inquiry</code></a></h3>
<div class="paragraph">
<p>Prefer Ruby&#8217;s comparison operators over Active Support&#8217;s <code>Array#inquiry</code>, and <code>String#inquiry</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - String#inquiry</span>
<span class="n">ruby</span> <span class="o">=</span> <span class="s1">'two'</span><span class="p">.</span><span class="nf">inquiry</span>
<span class="n">ruby</span><span class="p">.</span><span class="nf">two?</span>

<span class="c1"># good</span>
<span class="n">ruby</span> <span class="o">=</span> <span class="s1">'two'</span>
<span class="n">ruby</span> <span class="o">==</span> <span class="s1">'two'</span>

<span class="c1"># bad - Array#inquiry</span>
<span class="n">pets</span> <span class="o">=</span> <span class="sx">%w(cat dog)</span><span class="p">.</span><span class="nf">inquiry</span>
<span class="n">pets</span><span class="p">.</span><span class="nf">gopher?</span>

<span class="c1"># good</span>
<span class="n">pets</span> <span class="o">=</span> <span class="sx">%w(cat dog)</span>
<span class="n">pets</span><span class="p">.</span><span class="nf">include?</span> <span class="s1">'cat'</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="exclude"><a class="anchor" href="#exclude"></a><a class="link" href="#exclude"><code>exclude?</code></a></h3>
<div class="paragraph">
<p>Prefer Active Support&#8217;s <code>exclude?</code> over Ruby&#8217;s negated <code>include?</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="o">!</span><span class="n">array</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">!</span><span class="nb">hash</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="ss">:key</span><span class="p">)</span>
<span class="o">!</span><span class="n">string</span><span class="p">.</span><span class="nf">include?</span><span class="p">(</span><span class="s1">'substring'</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="n">array</span><span class="p">.</span><span class="nf">exclude?</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">hash</span><span class="p">.</span><span class="nf">exclude?</span><span class="p">(</span><span class="ss">:key</span><span class="p">)</span>
<span class="n">string</span><span class="p">.</span><span class="nf">exclude?</span><span class="p">(</span><span class="s1">'substring'</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="prefer-squiggly-heredoc"><a class="anchor" href="#prefer-squiggly-heredoc"></a><a class="link" href="#prefer-squiggly-heredoc">Prefer using squiggly heredoc over <code>strip_heredoc</code></a></h3>
<div class="paragraph">
<p>If you&#8217;re using Ruby 2.3 or higher, prefer squiggly heredoc (<code>&lt;&lt;~</code>) over Active Support&#8217;s <code>strip_heredoc</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="o">&lt;&lt;</span><span class="no">EOS</span><span class="p">.</span><span class="nf">strip_heredoc</span><span class="sh">
  some text
</span><span class="no">EOS</span>

<span class="c1"># bad</span>
<span class="o">&lt;&lt;-</span><span class="no">EOS</span><span class="p">.</span><span class="nf">strip_heredoc</span><span class="sh">
  some text
</span><span class="no">EOS</span>

<span class="c1"># good</span>
<span class="o">&lt;&lt;~</span><span class="no">EOS</span><span class="sh">
  some text
</span><span class="no">EOS</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="prefer-to-fs"><a class="anchor" href="#prefer-to-fs"></a><a class="link" href="#prefer-to-fs">Prefer <code>to_fs</code> for Formatted Strings</a></h3>
<div class="paragraph">
<p>If you&#8217;re using Rails 7.0 or higher, prefer <code>to_fs</code> over <code>to_formatted_s</code>. <code>to_formatted_s</code> is just too cumbersome for a method used that frequently.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">time</span><span class="p">.</span><span class="nf">to_formatted_s</span><span class="p">(</span><span class="ss">:db</span><span class="p">)</span>
<span class="n">date</span><span class="p">.</span><span class="nf">to_formatted_s</span><span class="p">(</span><span class="ss">:db</span><span class="p">)</span>
<span class="n">datetime</span><span class="p">.</span><span class="nf">to_formatted_s</span><span class="p">(</span><span class="ss">:db</span><span class="p">)</span>
<span class="mi">42</span><span class="p">.</span><span class="nf">to_formatted_s</span><span class="p">(</span><span class="ss">:human</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="n">time</span><span class="p">.</span><span class="nf">to_fs</span><span class="p">(</span><span class="ss">:db</span><span class="p">)</span>
<span class="n">date</span><span class="p">.</span><span class="nf">to_fs</span><span class="p">(</span><span class="ss">:db</span><span class="p">)</span>
<span class="n">datetime</span><span class="p">.</span><span class="nf">to_fs</span><span class="p">(</span><span class="ss">:db</span><span class="p">)</span>
<span class="mi">42</span><span class="p">.</span><span class="nf">to_fs</span><span class="p">(</span><span class="ss">:human</span><span class="p">)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="time"><a class="anchor" href="#time"></a><a class="link" href="#time">Time</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="tz-config"><a class="anchor" href="#tz-config"></a><a class="link" href="#tz-config">Time Zone Config</a></h3>
<div class="paragraph">
<p>Configure your timezone accordingly in <code>application.rb</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="n">config</span><span class="p">.</span><span class="nf">time_zone</span> <span class="o">=</span> <span class="s1">'Eastern European Time'</span>
<span class="c1"># optional - note it can be only :utc or :local (default is :utc)</span>
<span class="n">config</span><span class="p">.</span><span class="nf">active_record</span><span class="p">.</span><span class="nf">default_timezone</span> <span class="o">=</span> <span class="ss">:local</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="time-parse"><a class="anchor" href="#time-parse"></a><a class="link" href="#time-parse"><code>Time.parse</code></a></h3>
<div class="paragraph">
<p>Don&#8217;t use <code>Time.parse</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Time</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'2015-03-02 19:05:37'</span><span class="p">)</span> <span class="c1"># =&gt; Will assume time string given is in the system's time zone.</span>

<span class="c1"># good</span>
<span class="no">Time</span><span class="p">.</span><span class="nf">zone</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'2015-03-02 19:05:37'</span><span class="p">)</span> <span class="c1"># =&gt; Mon, 02 Mar 2015 19:05:37 EET +02:00</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="to-time"><a class="anchor" href="#to-time"></a><a class="link" href="#to-time"><code>to_time</code></a></h3>
<div class="paragraph">
<p>Don&#8217;t use <a href="https://api.rubyonrails.org/classes/String.html#method-i-to_time"><code>String#to_time</code></a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - assumes time string given is in the system's time zone.</span>
<span class="s1">'2015-03-02 19:05:37'</span><span class="p">.</span><span class="nf">to_time</span>

<span class="c1"># good</span>
<span class="no">Time</span><span class="p">.</span><span class="nf">zone</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="s1">'2015-03-02 19:05:37'</span><span class="p">)</span> <span class="c1"># =&gt; Mon, 02 Mar 2015 19:05:37 EET +02:00</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="time-now"><a class="anchor" href="#time-now"></a><a class="link" href="#time-now"><code>Time.now</code></a></h3>
<div class="paragraph">
<p>Don&#8217;t use <code>Time.now</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Time</span><span class="p">.</span><span class="nf">now</span> <span class="c1"># =&gt; Returns system time and ignores your configured time zone.</span>

<span class="c1"># good</span>
<span class="no">Time</span><span class="p">.</span><span class="nf">zone</span><span class="p">.</span><span class="nf">now</span> <span class="c1"># =&gt; Fri, 12 Mar 2014 22:04:47 EET +02:00</span>
<span class="no">Time</span><span class="p">.</span><span class="nf">current</span> <span class="c1"># Same thing but shorter.</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="date-time-range"><a class="anchor" href="#date-time-range"></a><a class="link" href="#date-time-range">Prefer <code>all_(day|week|month|quarter|year)</code> over range of date/time</a></h3>
<div class="paragraph">
<p>Prefer <code>all_(day|week|month|quarter|year)</code> over <code>beginning_of_(day|week|month|quarter|year)..end_of_(day|week|month|quarter|year)</code>
to get the range of date/time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">date</span><span class="p">.</span><span class="nf">beginning_of_day</span><span class="o">..</span><span class="n">date</span><span class="p">.</span><span class="nf">end_of_day</span>
<span class="n">date</span><span class="p">.</span><span class="nf">beginning_of_week</span><span class="o">..</span><span class="n">date</span><span class="p">.</span><span class="nf">end_of_week</span>
<span class="n">date</span><span class="p">.</span><span class="nf">beginning_of_month</span><span class="o">..</span><span class="n">date</span><span class="p">.</span><span class="nf">end_of_month</span>
<span class="n">date</span><span class="p">.</span><span class="nf">beginning_of_quarter</span><span class="o">..</span><span class="n">date</span><span class="p">.</span><span class="nf">end_of_quarter</span>
<span class="n">date</span><span class="p">.</span><span class="nf">beginning_of_year</span><span class="o">..</span><span class="n">date</span><span class="p">.</span><span class="nf">end_of_year</span>

<span class="c1"># good</span>
<span class="n">date</span><span class="p">.</span><span class="nf">all_day</span>
<span class="n">date</span><span class="p">.</span><span class="nf">all_week</span>
<span class="n">date</span><span class="p">.</span><span class="nf">all_month</span>
<span class="n">date</span><span class="p">.</span><span class="nf">all_quarter</span>
<span class="n">date</span><span class="p">.</span><span class="nf">all_year</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="duration"><a class="anchor" href="#duration"></a><a class="link" href="#duration">Duration</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="duration-application"><a class="anchor" href="#duration-application"></a><a class="link" href="#duration-application">Duration Application</a></h3>
<div class="paragraph">
<p>If used without a parameter, prefer <code>from_now</code> and <code>ago</code> instead of <code>since</code>, <code>after</code>, <code>until</code> or <code>before</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - It's not clear that the qualifier refers to the current time (which is the default parameter)</span>
<span class="mi">5</span><span class="p">.</span><span class="nf">hours</span><span class="p">.</span><span class="nf">since</span>
<span class="mi">5</span><span class="p">.</span><span class="nf">hours</span><span class="p">.</span><span class="nf">after</span>
<span class="mi">5</span><span class="p">.</span><span class="nf">hours</span><span class="p">.</span><span class="nf">before</span>
<span class="mi">5</span><span class="p">.</span><span class="nf">hours</span><span class="p">.</span><span class="nf">until</span>

<span class="c1"># good</span>
<span class="mi">5</span><span class="p">.</span><span class="nf">hours</span><span class="p">.</span><span class="nf">from_now</span>
<span class="mi">5</span><span class="p">.</span><span class="nf">hours</span><span class="p">.</span><span class="nf">ago</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If used with a parameter, prefer <code>since</code>, <code>after</code>, <code>until</code> or <code>before</code> instead of <code>from_now</code> and <code>ago</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - It's confusing and misleading to read</span>
<span class="mi">2</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">from_now</span><span class="p">(</span><span class="n">yesterday</span><span class="p">)</span>
<span class="mi">2</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">ago</span><span class="p">(</span><span class="n">yesterday</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="mi">2</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">since</span><span class="p">(</span><span class="n">yesterday</span><span class="p">)</span>
<span class="mi">2</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">after</span><span class="p">(</span><span class="n">yesterday</span><span class="p">)</span>
<span class="mi">2</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">before</span><span class="p">(</span><span class="n">yesterday</span><span class="p">)</span>
<span class="mi">2</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">until</span><span class="p">(</span><span class="n">yesterday</span><span class="p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Avoid using negative numbers for the duration subject. Always prefer using a qualifier that allows using positive literal numbers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad - It's confusing and misleading to read</span>
<span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="nf">hours</span><span class="p">.</span><span class="nf">from_now</span>
<span class="o">-</span><span class="mi">5</span><span class="p">.</span><span class="nf">hours</span><span class="p">.</span><span class="nf">ago</span>

<span class="c1"># good</span>
<span class="mi">5</span><span class="p">.</span><span class="nf">hours</span><span class="p">.</span><span class="nf">ago</span>
<span class="mi">5</span><span class="p">.</span><span class="nf">hours</span><span class="p">.</span><span class="nf">from_now</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="duration-arithmetic"><a class="anchor" href="#duration-arithmetic"></a><a class="link" href="#duration-arithmetic">Duration Arithmetic</a></h3>
<div class="paragraph">
<p>Use Duration methods instead of adding and subtracting with the current time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="no">Time</span><span class="p">.</span><span class="nf">current</span> <span class="o">-</span> <span class="mi">1</span><span class="p">.</span><span class="nf">minute</span>
<span class="no">Time</span><span class="p">.</span><span class="nf">zone</span><span class="p">.</span><span class="nf">now</span> <span class="o">+</span> <span class="mi">2</span><span class="p">.</span><span class="nf">days</span>

<span class="c1"># good</span>
<span class="mi">1</span><span class="p">.</span><span class="nf">minute</span><span class="p">.</span><span class="nf">ago</span>
<span class="mi">2</span><span class="p">.</span><span class="nf">days</span><span class="p">.</span><span class="nf">from_now</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="bundler"><a class="anchor" href="#bundler"></a><a class="link" href="#bundler">Bundler</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="dev-test-gems"><a class="anchor" href="#dev-test-gems"></a><a class="link" href="#dev-test-gems">Dev/Test Gems</a></h3>
<div class="paragraph">
<p>Put gems used only for development or testing in the appropriate group in the Gemfile.</p>
</div>
</div>
<div class="sect2">
<h3 id="only-good-gems"><a class="anchor" href="#only-good-gems"></a><a class="link" href="#only-good-gems">Only Good Gems</a></h3>
<div class="paragraph">
<p>Use only established gems in your projects.
If you&#8217;re contemplating on including some little-known gem you should do a careful review of its source code first.</p>
</div>
</div>
<div class="sect2">
<h3 id="gemfile-lock"><a class="anchor" href="#gemfile-lock"></a><a class="link" href="#gemfile-lock"><code>Gemfile.lock</code></a></h3>
<div class="paragraph">
<p>Do not remove the <code>Gemfile.lock</code> from version control.
This is not some randomly generated file - it makes sure that all of your team members get the same gem versions when they do a <code>bundle install</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="testing"><a class="anchor" href="#testing"></a><a class="link" href="#testing">Testing</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="integration-testing"><a class="anchor" href="#integration-testing"></a><a class="link" href="#integration-testing">Integration Testing</a></h3>
<div class="paragraph">
<p>Prefer integration style controller tests over functional style controller tests, <a href="https://api.rubyonrails.org/v7.0.0/classes/ActionController/TestCase.html">as recommended in the Rails documentation</a>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="k">class</span> <span class="nc">MyControllerTest</span> <span class="o">&lt;</span> <span class="no">ActionController</span><span class="o">::</span><span class="no">TestCase</span>
<span class="k">end</span>

<span class="c1"># good</span>
<span class="k">class</span> <span class="nc">MyControllerTest</span> <span class="o">&lt;</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">IntegrationTest</span>
<span class="k">end</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="freeze-time"><a class="anchor" href="#freeze-time"></a><a class="link" href="#freeze-time"><code>freeze_time</code></a></h3>
<div class="paragraph">
<p>Prefer <a href="https://api.rubyonrails.org/classes/ActiveSupport/Testing/TimeHelpers.html#method-i-freeze_time">ActiveSupport::Testing::TimeHelpers#freeze_time</a> over <a href="https://api.rubyonrails.org/classes/ActiveSupport/Testing/TimeHelpers.html#method-i-travel_to">ActiveSupport::Testing::TimeHelpers#travel_to</a> with an argument of the current time.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="ruby"><span class="c1"># bad</span>
<span class="n">travel_to</span><span class="p">(</span><span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">)</span>
<span class="n">travel_to</span><span class="p">(</span><span class="no">DateTime</span><span class="p">.</span><span class="nf">now</span><span class="p">)</span>
<span class="n">travel_to</span><span class="p">(</span><span class="no">Time</span><span class="p">.</span><span class="nf">current</span><span class="p">)</span>
<span class="n">travel_to</span><span class="p">(</span><span class="no">Time</span><span class="p">.</span><span class="nf">zone</span><span class="p">.</span><span class="nf">now</span><span class="p">)</span>
<span class="n">travel_to</span><span class="p">(</span><span class="no">Time</span><span class="p">.</span><span class="nf">now</span><span class="p">.</span><span class="nf">in_time_zone</span><span class="p">)</span>
<span class="n">travel_to</span><span class="p">(</span><span class="no">Time</span><span class="p">.</span><span class="nf">current</span><span class="p">.</span><span class="nf">to_time</span><span class="p">)</span>

<span class="c1"># good</span>
<span class="n">freeze_time</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="managing-processes"><a class="anchor" href="#managing-processes"></a><a class="link" href="#managing-processes">Managing Processes</a></h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="foreman"><a class="anchor" href="#foreman"></a><a class="link" href="#foreman">Foreman</a></h3>
<div class="paragraph">
<p>If your projects depends on various external processes use <a href="https://github.com/ddollar/foreman">foreman</a> to manage them.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="further-reading"><a class="anchor" href="#further-reading"></a><a class="link" href="#further-reading">Further Reading</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are a few excellent resources on Rails style, that you should consider if you have time to spare:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.informit.com/store/rails-5-way-9780134657677">The Rails 5 Way</a></p>
</li>
<li>
<p><a href="https://guides.rubyonrails.org/">Ruby on Rails Guides</a></p>
</li>
<li>
<p><a href="https://pragprog.com/titles/rspec3/effective-testing-with-rspec-3/">Effective Testing with RSpec 3</a></p>
</li>
<li>
<p><a href="https://pragprog.com/titles/hwcuc2/the-cucumber-book-second-edition/">The Cucumber Book</a></p>
</li>
<li>
<p><a href="https://leanpub.com/everydayrailsrspec">Everyday Rails Testing with RSpec</a></p>
</li>
<li>
<p><a href="https://pragprog.com/titles/nrtest3/rails-5-test-prescriptions/">Rails 5 Test Prescriptions</a></p>
</li>
<li>
<p><a href="https://rspec.rubystyle.guide">RSpec Style Guide</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="contributing"><a class="anchor" href="#contributing"></a><a class="link" href="#contributing">Contributing</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Nothing written in this guide is set in stone.
It&#8217;s my desire to work together with everyone interested in Rails coding style, so that we could ultimately create a resource that will be beneficial to the entire Ruby community.</p>
</div>
<div class="paragraph">
<p>Feel free to open tickets or send pull requests with improvements.
Thanks in advance for your help!</p>
</div>
<div class="paragraph">
<p>You can also support the project (and RuboCop) with financial contributions via <a href="https://www.patreon.com/bbatsov">Patreon</a>.</p>
</div>
<div class="sect2">
<h3 id="how-to-contribute"><a class="anchor" href="#how-to-contribute"></a><a class="link" href="#how-to-contribute">How to Contribute?</a></h3>
<div class="paragraph">
<p>It&#8217;s easy, just follow the contribution guidelines below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://help.github.com/articles/fork-a-repo">Fork</a> the <a href="https://github.com/rubocop/rails-style-guide">project</a> on GitHub</p>
</li>
<li>
<p>Make your feature addition or bug fix in a feature branch.</p>
</li>
<li>
<p>Include a <a href="http://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html">good description</a> of your changes</p>
</li>
<li>
<p>Push your feature branch to GitHub</p>
</li>
<li>
<p>Send a <a href="https://help.github.com/articles/using-pull-requests">Pull Request</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="license"><a class="anchor" href="#license"></a><a class="link" href="#license">License</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="image"><img src="https://i.creativecommons.org/l/by/3.0/88x31.png" alt="Creative Commons License"></span>
This work is licensed under a <a href="https://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spread-the-word"><a class="anchor" href="#spread-the-word"></a><a class="link" href="#spread-the-word">Spread the Word</a></h2>
<div class="sectionbody">
<div class="paragraph">
<p>A community-driven style guide is of little use to a community that doesn&#8217;t know about its existence.
Tweet about the guide, share it with your friends and colleagues.
Every comment, suggestion or opinion we get makes the guide just a little bit better.
And we want to have the best possible guide, don&#8217;t we?</p>
</div>
<div class="paragraph">
<p>Cheers,<br>
<a href="https://twitter.com/bbatsov">Bozhidar</a></p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-08-01 15:51:49 UTC
</div>
</div>
</body>
</html>